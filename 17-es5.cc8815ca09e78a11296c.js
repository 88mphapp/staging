!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"/yFf":function(e,t,r){"use strict";var n=r("oHnp");function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.get=function(e){return this.header[e.toLowerCase()]},i.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=n.type(t);var r=n.params(t);for(var i in r)this[i]=r[i];this.links={};try{e.link&&(this.links=n.parseLinks(e.link))}catch(o){}},i.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.created=201==e,this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e,this.unprocessableEntity=422==e}},"24Ii":function(e,t,r){var n;"undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:(console.warn("Using browser-only version of superagent in non-browser environment"),n=this);var i=r("cpc2"),o=r("kMlx"),s=r("8zgK"),a=r("/yFf"),u=r("nZbv");function c(){}var l=t=e.exports=function(e,r){return"function"==typeof r?new t.Request("GET",e).end(r):1==arguments.length?new t.Request("GET",e):new t.Request(e,r)};t.Request=y,l.getXHR=function(){if(!(!n.XMLHttpRequest||n.location&&"file:"==n.location.protocol&&n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var h="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function f(e){if(!s(e))return e;var t=[];for(var r in e)d(t,r,e[r]);return t.join("&")}function d(e,t,r){if(null!=r)if(Array.isArray(r))r.forEach(function(r){d(e,t,r)});else if(s(r))for(var n in r)d(e,t+"["+n+"]",r[n]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));else null===r&&e.push(encodeURIComponent(t))}function p(e){for(var t,r,n={},i=e.split("&"),o=0,s=i.length;o<s;++o)-1==(r=(t=i[o]).indexOf("="))?n[decodeURIComponent(t)]="":n[decodeURIComponent(t.slice(0,r))]=decodeURIComponent(t.slice(r+1));return n}function g(e){return/[\/+]json($|[^-\w])/.test(e)}function v(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=function(e){for(var t,r,n,i,o=e.split(/\r?\n/),s={},a=0,u=o.length;a<u;++a)-1!==(t=(r=o[a]).indexOf(":"))&&(n=r.slice(0,t).toLowerCase(),i=h(r.slice(t+1)),s[n]=i);return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body=null===this.text&&e._responseType?this.xhr.response:"HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function y(e,t){var r=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e,t=null,n=null;try{n=new v(r)}catch(i){return(t=new Error("Parser is unable to parse the response")).parse=!0,t.original=i,r.xhr?(t.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,t.status=r.xhr.status?r.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),r.callback(t)}r.emit("response",n);try{r._isResponseOK(n)||(e=new Error(n.statusText||"Unsuccessful HTTP response"))}catch(o){e=o}e?(e.original=t,e.response=n,e.status=n.status,r.callback(e,n)):r.callback(null,n)})}function E(e,t,r){var n=l("DELETE",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}l.serializeObject=f,l.parseString=p,l.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},l.serialize={"application/x-www-form-urlencoded":f,"application/json":JSON.stringify},l.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse},a(v.prototype),v.prototype._parseBody=function(e){var t=l.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&g(this.type)&&(t=l.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},v.prototype.toError=function(){var e=this.req,t=e.method,r=e.url,n=new Error("cannot "+t+" "+r+" ("+this.status+")");return n.status=this.status,n.method=t,n.url=r,n},l.Response=v,i(y.prototype),o(y.prototype),y.prototype.type=function(e){return this.set("Content-Type",l.types[e]||e),this},y.prototype.accept=function(e){return this.set("Accept",l.types[e]||e),this},y.prototype.auth=function(e,t,r){1===arguments.length&&(t=""),"object"==typeof t&&null!==t&&(r=t,t=""),r||(r={type:"function"==typeof btoa?"basic":"auto"});var n=function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,r,n)},y.prototype.query=function(e){return"string"!=typeof e&&(e=f(e)),e&&this._query.push(e),this},y.prototype.attach=function(e,t,r){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,r||t.name)}return this},y.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},y.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var r=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),r(e,t)},y.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},y.prototype.buffer=y.prototype.ca=y.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},y.prototype.pipe=y.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},y.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},y.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||c,this._finalizeQueryString(),this._end()},y.prototype._end=function(){var e=this,t=this.xhr=l.getXHR(),r=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var r=t.readyState;if(r>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==r){var n;try{n=t.status}catch(i){n=0}if(!n){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var n=function(t,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=t,e.emit("progress",r)};if(this.hasListeners("progress"))try{t.onprogress=n.bind(null,"download"),t.upload&&(t.upload.onprogress=n.bind(null,"upload"))}catch(a){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(u){return this.callback(u)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var i=this._header["content-type"],o=this._serializer||l.serialize[i?i.split(";")[0]:""];!o&&g(i)&&(o=l.serialize["application/json"]),o&&(r=o(r))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&t.setRequestHeader(s,this.header[s]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0!==r?r:null),this},l.agent=function(){return new u},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){u.prototype[e.toLowerCase()]=function(t,r){var n=new l.Request(e,t);return this._setDefaults(n),r&&n.end(r),n}}),u.prototype.del=u.prototype.delete,l.get=function(e,t,r){var n=l("GET",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},l.head=function(e,t,r){var n=l("HEAD",e);return"function"==typeof t&&(r=t,t=null),t&&n.query(t),r&&n.end(r),n},l.options=function(e,t,r){var n=l("OPTIONS",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.del=E,l.delete=E,l.patch=function(e,t,r){var n=l("PATCH",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.post=function(e,t,r){var n=l("POST",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n},l.put=function(e,t,r){var n=l("PUT",e);return"function"==typeof t&&(r=t,t=null),t&&n.send(t),r&&n.end(r),n}},"2k3W":function(e,t,r){"use strict";r.r(t),r.d(t,"bits",function(){return i}),r.d(t,"buffer",function(){return E}),r.d(t,"byte",function(){return _}),r.d(t,"integer",function(){return m}),r.d(t,"nibble",function(){return w}),r.d(t,"string",function(){return b});for(var n=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=1^e[r];return t},i={and:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=e[n]&t[n];return r},nand:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=e[n]&t[n]^1;return r},nor:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=1^(e[n]|t[n]);return r},not:n,or:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=e[n]|t[n];return r},reduceAnd:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t&=e[r];return t},reduceNand:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t=t&e[r]^1;return t},reduceNor:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t=1^(t|e[r]);return t},reduceOr:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t|=e[r];return t},reduceXnor:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t^=1^e[r];return t},reduceXor:function(e){if(e.length<2)throw new RangeError("Not enough bits.");for(var t=e[0],r=1;r<e.length;r++)t^=e[r];return t},toBoolean:function(e){for(var t=[],r=0;r<e.length;r++)t[r]=1===e[r];return t},toString:function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=" "),!t)return e.join("");for(var n="",i=0;i<e.length;i++)n+=""+e[i],i%t==t-1&&i!==e.length-1&&(n+=r);return n},xnor:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=e[n]^t[n]^1;return r},xor:function(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}},o=r("XUzR"),s=r("GCxg"),a=r("G1u+"),u=function(e){if(e>255||e<0||~~e!==e)throw new RangeError("invalid byte");for(var t=[0,0,0,0,0,0,0,0],r=0;r<8;r++)t[7-r]=e>>r&1;return t},c=function(e,t,r){void 0===t&&(t=0),r||(r=8*e.length-t);var n=Math.floor(t/8),i=Math.floor(r/8)+2,o=[];o.length=8*i;for(var s=0;s<i;s++)if(void 0!==e[n+s]){var a=u(e[n+s]);o[8*s]=a[0],o[8*s+1]=a[1],o[8*s+2]=a[2],o[8*s+3]=a[3],o[8*s+4]=a[4],o[8*s+5]=a[5],o[8*s+6]=a[6],o[8*s+7]=a[7]}var c=t%8;return o.slice(c,c+r)},l=r("nMdu"),h=r("ILq/"),f=r("f7RY"),d=r("YnKP"),p=[],g=0;g<32;g++)p[g]=Math.pow(2,g);var v=r("vGFC"),y=r("5tNv"),E={and:o.a,create:s.a,modify:function(e,t,r){void 0===r&&(r=0);for(var n=Math.floor(r/8),i=Math.ceil((r+t.length)/8),o=e.slice(n,i),s=c(o),u=r%8,l=0;l<t.length;l++)s[u++]=t[l];for(var h=i-n,f=0;f<h;f++)o[f]=Object(a.a)(s.slice(8*f,8*(f+1)))},nand:l.a,nor:h.a,not:f.a,or:d.a,read:c,readInt:function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=8);var i=c(e,t,r);if(0===i[0]){for(var o=0,s=0;s<r;s++)i[s]&&(o+=p[r-s-1]);return o}o=-1;var a=n(i);for(s=0;s<r;s++)a[s]&&(o-=p[r-s-1]);return o},readUInt:function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=8);for(var n=c(e,t,r),i=0,o=0;o<r;o++)i+=n[o]*p[r-o-1];return i},xnor:v.a,xor:y.a},_={read:u,write:a.a},m={getBit:function(e,t){return e>>t&1},setBit:function(e,t,r){return 1===r?e|1<<t:e&~(1<<t)},toggleBit:function(e,t){return e^1<<t}},w={read:function(e){if(e<16&&e>=0&&Math.floor(e)===e){for(var t=[0,0,0,0],r=0;r<4;r++)t[3-r]=e>>r&1;return t}throw new RangeError("invalid array length")},write:function(e){if(!Array.isArray(e)||4!==e.length)throw new RangeError("invalid array length");for(var t=0,r=0;r<4;r++)e[3-r]&&(t|=1<<r);return t}},b={toBits:function(e){for(var t=[],r=0;r<e.length;r++)"1"===e[r]?t.push(1):"0"===e[r]&&t.push(0);return t}};t.default={bits:i,buffer:E,byte:_,integer:m,nibble:w,string:b}},"4Mn8":function(e,t,r){var n=r("pzNo");e.exports={Client:n}},"5tNv":function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=t[n?s%t.length:s]^r[s];return o}}).call(this,r("tjlA").Buffer)},"6WMX":function(e,t,r){var n=r("B3Rj"),i=r("b3gk"),o=r("tjlA").Buffer,s=r("L21C"),a=o.from("01","hex"),u=r("L21C").HARDENED_OFFSET,c=[44+u,u,u,1,0],l={LEGACY:0,SEGWIT:5,TESTNET:111,SEGWIT_TESTNET:196};t.addressVersion=l;var h={P2PKH:1,P2SH:2,P2SH_P2WPKH:3};function f(e,t){return o.concat([e,t])}function d(e){var t=o.alloc(4);return t.writeUInt32LE(e),t}function p(e){var t;return e<253?(t=o.alloc(1)).writeUInt8(e):e<=65535?((t=o.alloc(3)).writeUInt8(253,0),t.writeUInt16LE(e,1)):e<4294967295?((t=o.alloc(5)).writeUInt8(254,0),t.writeUInt32LE(e,1)):((t=o.alloc(9)).writeUInt8(255,0),t.writeUInt32LE(e>>>0,1),t.writeUInt32LE(e/4294967296|0,5)),t}function g(e,t,r){"number"==typeof e&&(e=e.toString(16));var n=o.alloc(8),i=e.length%2==0?e.toString(16):"0".concat(e.toString(16));return o.from(i,"hex").reverse().copy(n,0),n.copy(t,r),n}t.scriptTypes=h,t.buildBitcoinTxRequest=function(e){try{var t=e.prevOuts,r=e.recipient,a=e.value,u=e.changePath,f=void 0===u?c:u,d=e.fee,p=e.isSegwit,v=e.changeVersion,y=void 0===v?"SEGWIT":v;if(5!==f.length)throw new Error("Please provide a full change path.");var E=o.alloc(59+69*t.length),_=0;if(void 0===l[y])throw new Error("Invalid change version specified.");E.writeUInt8(l[y]),_++,E.writeUInt32LE(f.length,_),_+=4;for(var m=0;m<f.length;m++)E.writeUInt32LE(f[m],_),_+=4;E.writeUInt32LE(d,_),_+=4;var w=n.decode(r)[0],b=i.decode(r).slice(1);E.writeUInt8(w,_),_++,b.copy(E,_),_+=b.length,g(a,E,_),_+=8,E.writeUInt8(t.length,_),_++;var S=0,R=!0===p?h.P2SH_P2WPKH:h.P2PKH;return t.forEach(function(e){if(!e.signerPath||5!==e.signerPath.length)throw new Error("Full recipient path not specified ");E.writeUInt32LE(e.signerPath.length,_),_+=4;for(var t=0;t<e.signerPath.length;t++)E.writeUInt32LE(e.signerPath[t],_),_+=4;E.writeUInt32LE(e.index,_),_+=4,g(e.value,E,_),_+=8,S+=e.value,E.writeUInt8(R,_),_++,o.isBuffer(e.txHash)||(e.txHash=o.from(e.txHash,"hex")),e.txHash.copy(E,_),_+=e.txHash.length}),{payload:E,schema:s.signingSchema.BTC_TRANSFER,origData:e,changeData:{changeVersion:y,value:S-(a+d)}}}catch(I){return{err:I}}},t.serializeTx=function(e){var t=e.inputs,r=e.outputs,s=e.isSegwitSpend,u=e.lockTime,c=void 0===u?0:u,h=e.crypto,v=o.alloc(4),y=0;v.writeUInt32LE(2,y),y+=4,!0===s&&(v=f(v,o.from("00","hex")),v=f(v,o.from("01","hex")));var E=p(t.length);v=f(v,E),y+=E.length,t.forEach(function(e){v=f(v,e.hash.reverse()),y+=e.hash.length;var t=d(e.index);if(v=f(v,t),y+=t.length,!0===s){var r=function(e,t){var r=o.alloc(22),n=t.createHash("sha256").update(e).digest(),i=t.createHash("rmd160").update(n).digest();return r.writeUInt8(0),r.writeUInt8(i.length,1),i.copy(r,2),r}(e.pubkey,h),n=p(r.length),i=o.concat([n,r]),u=p(i.length);v=f(v,u),y+=u.length,v=f(v,i),y+=i.length}else{var c=function(e,t){var r=p((e=o.concat([e,a])).length),n=p(t.length),i=o.concat([r,e,n,t]),s=p(i.length);return o.concat([s,i])}(e.sig,e.pubkey);v=f(v,c),y+=c.length}var l=d(4294967295);v=f(v,l),y+=l.length});var _=p(r.length);if(v=f(v,_),y+=_.length,r.forEach(function(e){var t,r,s=(t=e.value,r=o.alloc(8),g(t,r,0),r);v=f(v,s),y+=s.length;var a,u,c,h=(a=e.recipient,u=n.decode(a)[0],c=i.decode(a).slice(1),u===l.SEGWIT||u===l.SEGWIT_TESTNET?function(e){var t=o.alloc(3+e.length),r=0;return t.writeUInt8(169,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(135,r),r++,t}(c):function(e){var t=o.alloc(5+e.length),r=0;return t.writeUInt8(118,r),r++,t.writeUInt8(169,r),r++,t.writeUInt8(e.length,r),r++,e.copy(t,r),r+=e.length,t.writeUInt8(136,r),r++,t.writeUInt8(172,r),r++,t}(c)),d=p(h.length);v=f(v,d),y+=d.length,v=f(v,h),y+=h.length}),!0===s){for(var m=[],w=[],b=0;b<t.length;b++)m.push(t[b].sig),w.push(t[b].pubkey);var S=function(e,t){var r=o.alloc(0),n=o.alloc(1);n.writeUInt8(2);for(var i=0;i<e.length;i++){var s=o.concat([e[i],a]),u=p(s.length),c=t[i],l=p(c.length);r=o.concat([r,n,u,s,l,c])}return r}(m,w);v=f(v,S),y+=S.length}return o.concat([v,d(c)]).toString("hex")},t.getBitcoinAddress=function(e,t){return i.encode(o.concat([o.from([t]),e]))}},"8zgK":function(e,t,r){"use strict";e.exports=function(e){return null!==e&&"object"==typeof e}},"G1u+":function(e,t,r){"use strict";t.a=function(e){if(!Array.isArray(e)||8!==e.length)throw new RangeError("invalid array length");for(var t=0,r=0;r<8;r++)e[7-r]&&(t|=1<<r);return t}},GCxg:function(e,t,r){"use strict";(function(e){var n=r("G1u+");t.a=function(t){for(var r=[0,0,0,0,0,0,0,0],i=e.alloc(Math.ceil(t.length/8)),o=0;o<i.length;o++){for(var s=0;s<8;s++)r[s]=t[8*o+s]?t[8*o+s]:0;i[o]=Object(n.a)(r)}return i}}).call(this,r("tjlA").Buffer)},"ILq/":function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=~(t[n?s%t.length:s]|r[s]);return o}}).call(this,r("tjlA").Buffer)},L21C:function(e,t){var n,i={finalizePair:0,getAddresses:1290,sign:1090,getWallets:142,addAbiDefs:8,test:1646},o=0;Object.keys(i).forEach(function(e){i[e]+82>o&&(o=i[e]+82)});var s={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WALLET_NOT_PRESENT:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141};e.exports={getFwVersionConst:function(e){var t={reqMaxDataSz:1152};return 0===e.length||e[1]<10&&0===e[2]?(t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1):e[1]>=10&&e[2]>=0&&(t.reqMaxDataSz=1678,t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0),t},ADDR_STR_LEN:129,AES_IV:[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100],BASE_URL:"https://signing.gridpl.us",ENC_MSG_LEN:o,addressSizes:{BTC:20,ETH:20},decResLengths:i,deviceCodes:{CONNECT:1,ENCRYPTED_REQUEST:2},encReqCodes:{FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_ABI_DEFS:6,TEST:7},ethMsgProtocol:{SIGN_PERSONAL:0},messageConstants:{NOT_PAIRED:0,PAIRED:1},responseCodes:s,responseMsgs:(n={},r(n,s.RESP_SUCCESS,0),r(n,s.RESP_ERR_INVALID_MSG,"Invalid Request"),r(n,s.RESP_ERR_UNSUPPORTED_VER,"Unsupported Version"),r(n,s.RESP_ERR_DEV_BUSY,"Device Busy"),r(n,s.RESP_ERR_USER_TIMEOUT,"Timeout Waiting for User"),r(n,s.RESP_ERR_USER_DECLINED,"Request Declined by User"),r(n,s.RESP_ERR_PAIR_FAIL,"Pairing Failed"),r(n,s.RESP_ERR_PAIR_DISABLED,"Pairing is Currently Disabled"),r(n,s.RESP_ERR_PERMISSION_DISABLED,"Automated Signing is Currently Disabled"),r(n,s.RESP_ERR_INTERNAL,"Device Error"),r(n,s.RESP_ERR_GCE_TIMEOUT,"Timeout"),r(n,s.RESP_ERR_WALLET_NOT_PRESENT,"Incorrect Wallet UID Provided"),r(n,s.RESP_ERR_DEV_LOCKED,"Device Locked"),r(n,s.RESP_ERR_DISABLED,"Disabled"),r(n,s.RESP_ERR_ALREADY,"Record already exists. You must first remove it on your device."),n),signingSchema:{BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3},REQUEST_TYPE_BYTE:2,VERSION_BYTE:1,HARDENED_OFFSET:2147483648,HANDLE_LARGER_CHAIN_ID:255,MAX_CHAIN_ID_BYTES:8,ETH_ABI_LATTICE_FW_TYPE_MAP:{address:1,bool:2,uint8:3,uint16:4,uint32:5,uint64:6,uint128:7,uint256:8,uint:15,bytes1:17,bytes2:18,bytes3:19,bytes4:20,bytes5:21,bytes6:22,bytes7:23,bytes8:24,bytes9:25,bytes10:26,bytes11:27,bytes12:28,bytes13:29,bytes14:30,bytes15:31,bytes16:32,bytes17:33,bytes18:34,bytes19:35,bytes20:36,bytes21:37,bytes22:38,bytes23:39,bytes24:40,bytes25:41,bytes26:42,bytes27:43,bytes28:44,bytes29:45,bytes30:46,bytes31:47,bytes32:48,bytes:49,string:50}}},PLHu:function(e,t,r){var n=r("6WMX").buildBitcoinTxRequest,i=r("xKF7"),o=i.buildEthereumTxRequest,s=i.buildEthereumMsgRequest,a=i.ensureHexBuffer,u=r("tjlA").Buffer,c=r("cke4"),l=r("cC09"),h=r("MzeL"),f=r("L21C"),d=f.AES_IV,p=f.responseCodes,g=f.responseMsgs,v=f.VERSION_BYTE,y=new(0,h.ec)("p256");function E(e){return l.buf(e)>>>0}e.exports={isValidAssetPath:function(e){return[2147483697,2147483692].indexOf(e[0])>=0&&[2147483648,2147483649,2147483708].indexOf(e[1])>=0&&[2147483648].indexOf(e[2])>=0&&[0,1].indexOf(e[3])>=0},ensureHexBuffer:a,signReqResolver:{BTC:n,ETH:o,ETH_MSG:s},aes256_decrypt:function(e,t){var r=u.from(d),n=new c.ModeOfOperation.cbc(t,r);return u.from(n.decrypt(e))},aes256_encrypt:function(e,t){var r=u.from(d),n=new c.ModeOfOperation.cbc(t,r),i=e.length%16==0?e:c.padding.pkcs7.pad(e);return u.from(n.encrypt(i))},parseDER:function(e){if(48!==e[0]||2!==e[2])return null;var t=3,r={r:null,s:null},n=e[t];if(t++,r.r=e.slice(t,t+n),2!==e[t+=n])return null;var i=e[++t];return t++,r.s=e.slice(t,t+i),r},checksum:E,parseLattice1Response:function(e){var t={err:null,data:null},r=u.from(e,"hex"),n=0,i=r.readUInt8(n);if(n++,i!==v)return t.err="Incorrect protocol version. Please update your SDK",t;var o=r.readUInt8(n);if(n++,0!==o)return t.err="Incorrect response from Lattice1",t;r.readUInt32BE(n),n+=4;var s=r.readUInt16BE(n);n+=2;var a=r.slice(n,n+s);n+=s;var c=a.readUInt8(0);return c!==p.RESP_SUCCESS?(t.err="Error from device: ".concat(g[c]?g[c]:"Unknown Error"),t.responseCode=c,t):(t.data=a.slice(1,a.length),r.readUInt32BE(n)!==E(r.slice(0,r.length-4))?(t.err="Invalid checksum from device response",t.data=null,t):t)},getP256KeyPair:function(e){return y.keyFromPrivate(e,"hex")},getP256KeyPairFromPub:function(e){return y.keyFromPublic(e,"hex")},toPaddedDER:function(e){var t=u.alloc(74);return u.from(e.toDER()).copy(t),t}}},RP9m:function(e,t,r){var n=r("9lTW"),i=r("tjlA").Buffer;function o(e,t){if("00"===e.slice(0,2))throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}function s(e,t){if(e<56)return new i([e+t]);var r=c(e),n=c(t+55+r.length/2);return new i(n+r,"hex")}function a(e){var t,r,n,s,u,c=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,n=128===l?new i([]):e.slice(1,t),2===t&&n[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:n,remainder:e.slice(t)}}if(l<=191){if(t=o(e.slice(1,r=l-182).toString("hex"),16),(n=e.slice(r,t+r)).length<t)throw new Error("invalid RLP");return{data:n,remainder:e.slice(t+r)}}if(l<=247){for(s=e.slice(1,t=l-191);s.length;)u=a(s),c.push(u.data),s=u.remainder;return{data:c,remainder:e.slice(t)}}var h=(r=l-246)+(t=o(e.slice(1,r).toString("hex"),16));if(h>e.length)throw new Error("invalid rlp: total length is larger than the data");if(0===(s=e.slice(r,h)).length)throw new Error("invalid rlp, List has a invalid length");for(;s.length;)u=a(s),c.push(u.data),s=u.remainder;return{data:c,remainder:e.slice(h)}}function u(e){return"0x"===e.slice(0,2)}function c(e){var t=e.toString(16);return t.length%2&&(t="0"+t),t}function l(e){if(!i.isBuffer(e))if("string"==typeof e)e=u(e)?new i(((r="string"!=typeof(n=e)?n:u(n)?n.slice(2):n).length%2&&(r="0"+r),r),"hex"):new i(e);else if("number"==typeof e)e?(t=c(e),e=new i(t,"hex")):e=new i([]);else if(null==e)e=new i([]);else{if(!e.toArray)throw new Error("invalid type");e=new i(e.toArray())}var t,r,n;return e}t.encode=function(e){if(e instanceof Array){for(var r=[],n=0;n<e.length;n++)r.push(t.encode(e[n]));var o=i.concat(r);return i.concat([s(o.length,192),o])}return 1===(e=l(e)).length&&e[0]<128?e:i.concat([s(e.length,128),e])},t.decode=function(e,t){if(!e||0===e.length)return new i([]);var r=a(e=l(e));return t?r:(n.equal(r.remainder.length,0,"invalid remainder"),r.data)},t.getLength=function(e){if(!e||0===e.length)return new i([]);var t=(e=l(e))[0];if(t<=127)return e.length;if(t<=183)return t-127;if(t<=191)return t-182;if(t<=247)return t-191;var r=t-246;return r+o(e.slice(1,r).toString("hex"),16)}},T8MV:function(e,t,r){(function(t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r("HEbw"),h=r("+qE3").EventEmitter,f=r("4Mn8"),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(d,e);var r,n,o,h=(n=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=c(n);if(o){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,d),(e=h.call(this)).type="Lattice Hardware",e._resetDefaults(),e.deserialize(t),e}return(r=[{key:"deserialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.creds&&(this.creds=e.creds),e.accounts&&(this.accounts=e.accounts),e.walletUID&&(this.walletUID=e.walletUID),e.name&&(this.name=e.name),e.network&&(this.network=e.network),Promise.resolve()}},{key:"serialize",value:function(){return Promise.resolve({creds:this.creds,accounts:this.accounts,walletUID:this.walletUID,name:this.name,network:this.network})}},{key:"isUnlocked",value:function(){return this._hasCreds()&&this._hasSession()}},{key:"setHdPath",value:function(){console.warn("setHdPath not implemented.")}},{key:"unlock",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise(function(r,n){e._getCreds().then(function(t){return t&&(e.creds.deviceID=t.deviceID,e.creds.password=t.password),e._initSession()}).then(function(){return e._connect(t)}).then(function(){return r("Unlocked")}).catch(function(e){return n(Error(e))})})}},{key:"addAccounts",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise(function(r,n){return-1e3===t?(e.forgetDevice(),r([])):t<=0?n("Number of accounts to add must be a positive number."):void e.unlock().then(function(){return e._fetchAddresses(t,e.unlockedAccount)}).then(function(n){var o;return e.accounts.splice(e.unlockedAccount,t),(o=e.accounts).splice.apply(o,[e.unlockedAccount,0].concat(i(n))),r(e.accounts)}).catch(function(e){return n(e)})})}},{key:"getAccounts",value:function(){return Promise.resolve(this.accounts?this.accounts.slice():[].slice())}},{key:"signTransaction",value:function(e,r){var n=this;return new Promise(function(i,o){n._unlockAndFindAccount(e).then(function(e){var t={chainId:r.getChainId(),nonce:Number("0x".concat(r.nonce.toString("hex")))||0,gasPrice:Number("0x".concat(r.gasPrice.toString("hex"))),gasLimit:Number("0x".concat(r.gasLimit.toString("hex"))),to:"0x".concat(r.to.toString("hex")),value:Number("0x".concat(r.value.toString("hex"))),data:0===r.data.length?null:"0x".concat(r.data.toString("hex")),signerPath:[2147483692,2147483708,2147483648,0,e]};return n._signTxData(t)}).then(function(e){return e.sig&&e.sig.v&&e.sig.r&&e.sig.s?(r.v=e.sig.v,r.r=t.from(e.sig.r,"hex"),r.s=t.from(e.sig.s,"hex"),i(r)):o(Error("No signature returned"))}).catch(function(e){return o(Error(e))})})}},{key:"signPersonalMessage",value:function(e,t){return this.signMessage(e,{payload:t,protocol:"signPersonal"})}},{key:"signMessage",value:function(e,t){var r=this;return new Promise(function(n,i){r._unlockAndFindAccount(e).then(function(e){var o=t.payload,s=t.protocol;if(!o||!s)return i("`payload` and `protocol` fields must be included in the request");var a={currency:"ETH_MSG",data:{protocol:s,payload:o,signerPath:[2147483692,2147483708,2147483648,0,e]}};if(!r._hasSession())return i("No SDK session started. Cannot sign transaction.");r.sdkSession.sign(a,function(e,t){if(e)return i(e);if(!t.sig)return i("No signature returned");var r=(t.sig.v-27).toString(16);return r.length<2&&(r="0".concat(r)),n("0x".concat(t.sig.r).concat(t.sig.s).concat(r))})})})}},{key:"exportAccount",value:function(e){return Promise.reject(Error("exportAccount not supported by this device"))}},{key:"removeAccount",value:function(e){this.forgetDevice()}},{key:"getFirstPage",value:function(){return this.page=0,this._getPage(1)}},{key:"getNextPage",value:function(){return this.getFirstPage()}},{key:"getPreviousPage",value:function(){return this.getFirstPage()}},{key:"setAccountToUnlock",value:function(e){this.unlockedAccount=parseInt(e,10)}},{key:"forgetDevice",value:function(){this._resetDefaults()}},{key:"_unlockAndFindAccount",value:function(e){var t=this;return new Promise(function(r,n){t.unlock(!1).then(function(){return t.getAccounts()}).then(function(t){var i=null;return t.forEach(function(t,r){e.toLowerCase()===t.toLowerCase()&&(i=r)}),null===i?n("Signer not present"):r(i)}).catch(function(e){return n(e)})})}},{key:"_resetDefaults",value:function(){this.accounts=[],this.isLocked=!0,this.creds={deviceID:null,password:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null}},{key:"_getCreds",value:function(){var e=this;return new Promise(function(t,r){if(e._hasCreds())return t();var n=e.name?e.name:"Unknown",i="https://wallet.gridplus.io";e.network&&"mainnet"!==e.network&&(i="https://gridplus-web-wallet-dev.herokuapp.com");var o="".concat(i,"?keyring=").concat(n);e.network&&(o+="&network=".concat(e.network)),window.open(o).postMessage("GET_LATTICE_CREDS",i),window.addEventListener("message",function(e){if(e.origin===i)try{var n=JSON.parse(e.data);return n.deviceID&&n.password?t(n):r(Error("Invalid credentials returned from Lattice."))}catch(o){return r(o)}},!1)})}},{key:"_connect",value:function(e){var t=this;return new Promise(function(r,n){t.sdkSession.connect(t.creds.deviceID,function(i){if(i)return n(i);var o=t.sdkSession.getActiveWallet();if(!o||!o.uid)return n("No active wallet");var s=o.uid.toString("hex");if(s!=t.walletUID){if(!1===e)return n("Wallet has changed! Please reconnect.");t.accounts=[],t.walletUID=s}return r()})})}},{key:"_initSession",value:function(){var e=this;return new Promise(function(t,r){if(e._hasSession())return t();try{var n="https://signing.gridpl.us";e.network&&"mainnet"!==e.network&&(n="https://signing.staging-gridpl.us");var i={name:e.name,baseUrl:n,crypto:l,timeout:12e4,privKey:e._genSessionKey(),network:e.network};return e.sdkSession=new f.Client(i),t()}catch(o){return r(o)}})}},{key:"_fetchAddresses",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(n,i){return e._hasSession()?r>e.accounts.length?i("Requested address is out of bounds. You may only request index <".concat(e.accounts.length)):e.accounts.length>r?n(e.accounts.slice(r,t)):void e.sdkSession.getAddresses({currency:"ETH",startPath:[2147483692,2147483708,2147483648,0,r],n:t},function(e,t){return e?i(Error("Error getting addresses: ".concat(e))):t.length<1?i("No addresses returned"):n(t)}):i("No SDK session started. Cannot fetch addresses.")})}},{key:"_signTxData",value:function(e){var t=this;return new Promise(function(r,n){if(!t._hasSession())return n("No SDK session started. Cannot sign transaction.");t.sdkSession.sign({currency:"ETH",data:e},function(e,t){return e?n(e):t.tx?r(t):n("No transaction payload returned.")})})}},{key:"_getPage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise(function(r,n){e.page+=t,e.page<=0&&(e.page=1);var i=5*(e.page-1);e.unlock().then(function(){return e._fetchAddresses(1,0)}).then(function(e){var t=[];return e.forEach(function(e,r){t.push({address:e,balance:null,index:i+r})}),r(t)}).catch(function(e){return n(e)})})}},{key:"_hasCreds",value:function(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.name}},{key:"_hasSession",value:function(){return this.sdkSession&&this.walletUID}},{key:"_genSessionKey",value:function(){if(!this._hasCreds())throw new Error("No credentials -- cannot create session key!");var e=t.concat([t.from(this.creds.password),t.from(this.creds.deviceID),t.from(this.name)]);return l.createHash("sha256").update(e).digest()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(d.prototype,r),d}(h);d.type="Lattice Hardware",e.exports=d}).call(this,r("tjlA").Buffer)},XUzR:function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=t[n?s%t.length:s]&r[s];return o}}).call(this,r("tjlA").Buffer)},YnKP:function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=t[n?s%t.length:s]|r[s];return o}}).call(this,r("tjlA").Buffer)},cC09:function(e,t,r){var n;n=function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)t[r]=e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,r){for(var n=-1^r,i=e.length-1,o=0;o<i;)n=(n=n>>>8^t[255&(n^e.charCodeAt(o++))])>>>8^t[255&(n^e.charCodeAt(o++))];return o===i&&(n=n>>>8^t[255&(n^e.charCodeAt(o))]),-1^n},e.buf=function(e,r){if(e.length>1e4)return function(e,r){for(var n=-1^r,i=e.length-7,o=0;o<i;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])];for(;o<i+7;)n=n>>>8^t[255&(n^e[o++])];return-1^n}(e,r);for(var n=-1^r,i=e.length-3,o=0;o<i;)n=(n=(n=(n=n>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])];for(;o<i+3;)n=n>>>8^t[255&(n^e[o++])];return-1^n},e.str=function(e,r){for(var n,i,o=-1^r,s=0,a=e.length;s<a;)(n=e.charCodeAt(s++))<128?o=o>>>8^t[255&(o^n)]:n<2048?o=(o=o>>>8^t[255&(o^(192|n>>6&31))])>>>8^t[255&(o^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),i=1023&e.charCodeAt(s++),o=(o=(o=(o=o>>>8^t[255&(o^(240|n>>8&7))])>>>8^t[255&(o^(128|n>>2&63))])>>>8^t[255&(o^(128|i>>6&15|(3&n)<<4))])>>>8^t[255&(o^(128|63&i))]):o=(o=(o=o>>>8^t[255&(o^(224|n>>12&15))])>>>8^t[255&(o^(128|n>>6&63))])>>>8^t[255&(o^(128|63&n))];return-1^o}},"undefined"==typeof DO_NOT_EXPORT_CRC?n(t):n({})},cpc2:function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},f7RY:function(e,t,r){"use strict";(function(e){t.a=function(t){for(var r=e.alloc(t.length),n=0;n<t.length;n++)r[n]=~t[n];return r}}).call(this,r("tjlA").Buffer)},kMlx:function(e,t,r){"use strict";var n=r("8zgK");function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},i.prototype.parse=function(e){return this._parser=e,this},i.prototype.responseType=function(e){return this._responseType=e,this},i.prototype.serialize=function(e){return this._serializer=e,this},i.prototype.timeout=function(e){if(!e||"object"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},i.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];i.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(e,t);if(!0===r)return!0;if(!1===r)return!1}catch(n){console.error(n)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~o.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"==e.code)return!0;if(e.crossDomain)return!0}return!1},i.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},i.prototype.then=function(e,t){if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){r.end(function(r,n){r?t(r):e(n)})})}return this._fullfilledPromise.then(e,t)},i.prototype.catch=function(e){return this.then(void 0,e)},i.prototype.use=function(e){return e(this),this},i.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},i.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},i.prototype.getHeader=i.prototype.get=function(e){return this._header[e.toLowerCase()]},i.prototype.set=function(e,t){if(n(e)){for(var r in e)this.set(r,e[r]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},i.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},i.prototype.field=function(e,t){if(null==e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),n(e)){for(var r in e)this.field(r,e[r]);return this}if(Array.isArray(t)){for(var i in t)this.field(e,t[i]);return this}if(null==t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},i.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},i.prototype._auth=function(e,t,r,n){switch(r.type){case"basic":this.set("Authorization","Basic "+n(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},i.prototype.withCredentials=function(e){return null==e&&(e=!0),this._withCredentials=e,this},i.prototype.redirects=function(e){return this._maxRedirects=e,this},i.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw TypeError("Invalid argument");return this._maxResponseSize=e,this},i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},i.prototype.send=function(e){var t=n(e),r=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&n(this._data))for(var i in e)this._data[i]=e[i];else"string"==typeof e?(r||this.type("form"),this._data="application/x-www-form-urlencoded"==(r=this._header["content-type"])?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)||r||this.type("json"),this},i.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},i.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var r=this.url.substring(t+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.substring(0,t)+"?"+r.join("&")}}},i.prototype._appendQueryString=function(){console.trace("Unsupported")},i.prototype._timeoutError=function(e,t,r){if(!this._aborted){var n=new Error(e+t+"ms exceeded");n.timeout=t,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.abort(),this.callback(n)}},i.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},nMdu:function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=~(t[n?s%t.length:s]&r[s]);return o}}).call(this,r("tjlA").Buffer)},nZbv:function(e,t){function r(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){r.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),r.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=r},oHnp:function(e,t,r){"use strict";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var r=t.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(e[n]=i),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var r=t.split(/ *; */),n=r[0].slice(1,-1);return e[r[1].split(/ *= */)[1].slice(1,-1)]=n,e},{})},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},pzNo:function(r,n,i){var o=i("2k3W"),s=i("24Ii"),a=i("6WMX"),u=i("xKF7"),c=i("u0zn"),l=c.buildAddAbiPayload,h=c.abiParsers,f=c.MAX_ABI_DEFS,d=i("PLHu"),p=d.isValidAssetPath,g=d.signReqResolver,v=d.aes256_decrypt,y=d.aes256_encrypt,E=d.parseDER,_=d.checksum,m=d.ensureHexBuffer,w=d.getP256KeyPair,b=d.getP256KeyPairFromPub,S=d.parseLattice1Response,R=d.toPaddedDER,I=i("L21C"),T=I.getFwVersionConst,A=I.ADDR_STR_LEN,P=I.ENC_MSG_LEN,x=I.decResLengths,k=I.deviceCodes,D=I.encReqCodes,C=I.responseCodes,U=I.REQUEST_TYPE_BYTE,L=I.VERSION_BYTE,N=I.messageConstants,O=I.BASE_URL,M=i("tjlA").Buffer,B=M.alloc(32);r.exports=function(){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.baseUrl,i=t.crypto,o=t.name,s=t.privKey,a=t.timeout,u=t.retryCount;if(e(this,r),o&&o.length>24)throw new Error("name must be less than 24 characters");if(!i)throw new Error("crypto provider is required");this.baseUrl=n||O,this.crypto=i,this.name=o||"Unknown",this.privKey=s||this.crypto.randomBytes(32),this.key=w(this.privKey),this.ephemeralPub=null,this.sharedSecret=null,this.timeout=a||6e4,this.deviceId=null,this.isPaired=!1,this.retryCount=u||3,this.activeWallets={internal:{uid:B,name:null,capabilities:null,external:!1},external:{uid:B,name:null,capabilities:null,external:!0}}}var n,i,c;return n=r,(i=[{key:"connect",value:function(e,t){var r=this;if("function"==typeof e){if(!this.deviceId)return t("No device ID has been stored. Please connect with your device ID first.");t=e}else this.deviceId=e;var n=this._buildRequest(k.CONNECT,this.pubKeyBytes());this._request(n,function(e,n){return e?t(e):(r.isPaired=r._handleConnect(n),r.isPaired?void r._getActiveWallet(function(e){return t(e,r.isPaired)},!0):t(null))})}},{key:"pair",value:function(e,t){var r=this,n=this.pubKeyBytes(),i=M.alloc(25);if(this.name.length>24)return t("Name is too many characters. Please change it to <25 characters.");i.write(this.name);var o=M.concat([n,i,M.from(e)]),s=this.crypto.createHash("sha256").update(o).digest(),a=this.key.sign(s),u=R(a),c=M.concat([i,u]),l=this._buildEncRequest(D.FINALIZE_PAIRING,c);this._request(l,function(e,n){if(e)return t(e);var i=r._handlePair(n);if(i)return t(i);r._getActiveWallet(function(e){return e?t(e):t(null,r.hasActiveWallet())},!0)})}},{key:"test",value:function(e,t){var r=this;if(!e.payload)return t("First argument must contain `testID` and `payload` fields.");var n=M.alloc(506);n.writeUInt32BE(e.testID,0),n.writeUInt16BE(e.payload.length,4),e.payload.copy(n,6);var i=this._buildEncRequest(D.TEST,n);this._request(i,function(e,n){if(e)return t(e);var i=r._handleEncResponse(n,x.test);return null!==i.err?t(i.err):t(null,i.data.slice(65))})}},{key:"getAddresses",value:function(e,t){var r=this,n=e.startPath,i=e.n,s=e.skipCache,a=void 0===s||s;if(void 0===n||void 0===i||5!==n.length)return t("Please provide `startPath` and `n` options");if(i>10)return t("You may only request 10 addresses at once.");if(!0===a&&!1===p(n))return t("Parent path is not supported");var u,c=M.alloc(33+4*n.length),l=0,h=this.getActiveWallet();if(null===h)return t("No active wallet.");h.uid.copy(c,l),l+=32;for(var f=0;f<n.length;f++)c.writeUInt32BE(n[f],l),l+=4;if(!0===T(this.fwVersion).addrFlagsAllowed){var d=o.nibble.read(!0===a?1:0),g=o.nibble.read(i);u=o.byte.write(d.concat(g))}else u=i;c.writeUInt8(u,l),l++;var v=this._buildEncRequest(D.GET_ADDRESSES,c);return this._request(v,function(e,n){if(e)return t(e);var i=r._handleGetAddresses(n);return i.err?t(i.err):t(null,i.data)})}},{key:"sign",value:function(e,t){var r=this,n=e.currency,i=e.data;if(void 0===n||void 0===i)return t("Please provide `currency` and `data` options");if(void 0===g[n])return t("Unsupported currency");var o=T(this.fwVersion);i.ethMaxDataSz=o.ethMaxDataSz,i.ethMaxMsgSz=o.ethMaxMsgSz;var s=g[n](i);if(void 0!==s.err)return t({err:s.err});if(s.payload.length>o.reqMaxDataSz)return t("Transaction is too large");var a=M.alloc(2+o.reqMaxDataSz),u=0;a.writeUInt16BE(s.schema,u),u+=2;var c=this.getActiveWallet();if(null===c)return t("No active wallet.");c.uid.copy(a,u),u+=c.uid.length,s.payload.copy(a,u);var l=this._buildEncRequest(D.SIGN_TRANSACTION,a);return this._request(l,function(i,o,a){if(a===C.RESP_ERR_WALLET_NOT_PRESENT)r._getActiveWallet(function(n){return n?t(n):r.sign(e,t)});else{if(!i){var u=r._handleSign(o,n,s);return t(u.err,u.data)}if(i)return t(i)}})}},{key:"addAbiDefs",value:function(e,t){var r,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.slice(0,f);e=e.slice(f);try{r=l(o)}catch(u){return t(u)}var s=M.alloc(r.length+10);s.writeUInt16LE(e.length),null!==i&&i.copy(s,2),r.copy(s,10);var a=this._buildEncRequest(D.ADD_ABI_DEFS,s);return this._request(a,function(r,o,s){if(s&&s!==C.RESP_SUCCESS)return t("Error making request.");if(r)return t(r);var a=n._handleEncResponse(o,x.addAbiDefs);if(i=a.data.slice(65,73),0===e.length)return t(null);n.addAbiDefs(e,t,i,e)})}},{key:"addPermissionV0",value:function(e,t){var r=this,n=e.currency,i=e.timeWindow,o=e.limit,s=e.decimals,a=e.asset;if(!n||void 0===i||void 0===o||void 0===s||null===i||null===o||null===s)return t("currency, timeWindow, decimals, and limit are all required options.");if(0===i||0===o)return t("Time window and spending limit must be positive.");var u=n;a&&(u+="_".concat(a));var c=M.alloc(293);if(M.from(u).length>255)return t("Asset name too long.");M.from(u).copy(c,0);var l=m(o);if(l.length>32)return t("Limit too large.");l.copy(c,32-l.length+256),c.writeUInt32BE(i,288),c.writeUInt8(s,292);var h=this._buildEncRequest(D.ADD_PERMISSION_V0,c);return this._request(h,function(n,i,o){if(o===C.RESP_ERR_WALLET_NOT_PRESENT)r._getActiveWallet(function(n){return n?t(n):r.addPermissionV0(e,t)});else{if(!n){var s=r._handleEncResponse(i,x.finalizePair);return t(s.err?s.err:null)}if(n)return t(n)}})}},{key:"_getActiveWallet",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!0===r||!0!==this.hasActiveWallet()&&!0===this.isPaired){var n=M.alloc(0),i=this._buildEncRequest(D.GET_WALLETS,n);return this._request(i,function(r,n){return r?(t._resetActiveWallets(),e(r)):e(t._handleGetWallets(n))})}return e(null)}},{key:"_getSharedSecret",value:function(){return M.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))}},{key:"_getEphemId",value:function(){if(null===this.ephemeralPub)return null;var e=this._getSharedSecret();return this.crypto.createHash("sha256").update(e).digest().slice(0,4)}},{key:"_buildEncRequest",value:function(e,t){var r=parseInt(this._getEphemId().toString("hex"),16),n=M.concat([M.from([e]),t]),i=_(n),o=M.alloc(n.length+4);n.copy(o,0),o.writeUInt32LE(i,n.length);var s=this._getSharedSecret(),a=y(o,s),u=M.alloc(P+4);return u.writeUInt32LE(r,0),a.copy(u,4),this._buildRequest(k.ENCRYPTED_REQUEST,u)}},{key:"_buildRequest",value:function(e,t){var r=t&&M.isBuffer(t)?t.length+1:1;e===k.ENCRYPTED_REQUEST&&(r=1+t.length);var n=0,i=M.alloc(r+8);n=i.writeUInt8(L,n),n=i.writeUInt8(U,n);var o=this.crypto.randomBytes(4);n=i.writeUInt32BE(parseInt("0x".concat(o.toString("hex"))),n),n=i.writeUInt16BE(r,n),n=i.writeUInt8(e,n),r>1&&(n=t.copy(i,n));var s=_(i),a=M.alloc(i.length+4);return n=i.copy(a),a.writeUInt32BE(s,n),a}},{key:"_request",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.retryCount;if(!this.deviceId)return t("Serial is not set. Please set it and try again.");s.post("".concat(this.baseUrl,"/").concat(this.deviceId)).timeout(this.timeout).send({data:e}).then(function(i){if(!i||!i.body)return t("Invalid response: ".concat(i));if(200!==i.body.status)return t("Error code ".concat(i.body.status,": ").concat(i.body.message));var o=S(i.body.message);return(o.responseCode===C.RESP_ERR_DEV_BUSY||o.responseCode===C.RESP_ERR_GCE_TIMEOUT)&&n>0?setTimeout(function(){r._request(e,t,n-1)},3e3):(o.responseCode===C.RESP_ERR_WALLET_NOT_PRESENT&&r._resetActiveWallets(),o.err?t(o.err):t(null,o.data,o.responseCode))}).catch(function(e){return t("ECONNABORTED"===e.code&&"ETIME"===e.errno?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device.")})}},{key:"_handleConnect",value:function(e){var t=0,r=e.readUInt8(t);t++;var n=e.slice(t,t+65).toString("hex");return t+=65,this.fwVersion=e.slice(t,t+4),this.ephemeralPub=b(n),r===N.PAIRED}},{key:"_handleEncResponse",value:function(e,t){var r=this._getSharedSecret(),n=e.slice(0,P),i=v(n,r),o=i.slice(0,t+=65),s=parseInt("0x".concat(i.slice(t,t+4).toString("hex"))),a=_(o);if(s!==a)return{err:"Checksum mismatch in response from Lattice (calculated ".concat(a,", wanted ").concat(s,")")};var u=i.slice(0,65).toString("hex");try{return this.ephemeralPub=b(u),{err:null,data:i}}catch(c){return{err:"Error handling getAddresses response: ".concat(c.toString())}}}},{key:"_handlePair",value:function(e){var t=this._handleEncResponse(e,x.finalizePair);return t.err?t.err:(this.pairingSalt=null,this.isPaired=!0,null)}},{key:"_handleGetAddresses",value:function(e){var t=this._handleEncResponse(e,x.getAddresses);if(null!==t.err)return t;for(var r=t.data,n=65,i=[];n+4<x.getAddresses;){var o=r.slice(n,n+A);n+=A;var s=o.indexOf(0);s>0&&i.push(o.slice(0,s).toString())}return{data:i,err:null}}},{key:"_handleGetWallets",value:function(e){var t=this._handleEncResponse(e,x.getWallets);if(null!==t.err)return t;var r,n=t.data,i=65,o=!1;return r=n.slice(i,i+32),this.activeWallets.internal.uid=r,this.activeWallets.internal.capabilities=n.readUInt32BE(i+32),this.activeWallets.internal.name=n.slice(i+36,i+71),r.equals(B)||(o=!0),i+=71,r=n.slice(i,i+32),this.activeWallets.external.uid=r,this.activeWallets.external.capabilities=n.readUInt32BE(i+32),this.activeWallets.external.name=n.slice(i+36,i+71),r.equals(B)||(o=!0),!0===o?null:"No active wallet."}},{key:"_handleSign",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this._handleEncResponse(e,x.sign);if(null!==n.err)return{err:n.err};var i,o=65,s=n.data;if("BTC"===t){var c=a.addressVersion[r.changeData.changeVersion],l=s.slice(o,o+20);o+=20,i=a.getBitcoinAddress(l,c)}var h={err:null,data:null};if("BTC"===t){for(var f=33,d=[],p=[],g=0;o<s.length&&48===s[o];)p.push(s.slice(o,o+2+s[o+1])),d.push(s.slice(g*f+825,(g+1)*f+825)),o+=74,g+=1;var v={inputs:[],outputs:[],isSegwitSpend:r.origData.isSegwit,network:r.origData.network,crypto:this.crypto};v.outputs.push({value:r.origData.value,recipient:r.origData.recipient}),r.changeData.value>0&&v.outputs.push({value:r.changeData.value,recipient:i});for(var y=0;y<p.length;y++)v.inputs.push({hash:r.origData.prevOuts[y].txHash,index:r.origData.prevOuts[y].index,sig:p[y],pubkey:d[y]});var _=a.serializeTx(v),m=_;!0===v.isSegwitSpend&&(v.isSegwitSpend=!1,m=a.serializeTx(v));var w=this.crypto.createHash("sha256").update(M.from(m,"hex")).digest();w=this.crypto.createHash("sha256").update(w).digest().reverse().toString("hex"),h.data={tx:_,txHash:w,changeRecipient:i,sigs:p}}else if("ETH"===t){var b=E(s.slice(o,o+2+s[o+1]));o+=74;var S=s.slice(o,o+20),R=u.buildEthRawTx(r,b,S,r.useEIP155);h.data={tx:"0x".concat(R),txHash:"0x".concat(u.hashTransaction(R)),sig:{v:b.v,r:b.r.toString("hex"),s:b.s.toString("hex")},signer:S}}else if("ETH_MSG"===t){var I=E(s.slice(o,o+2+s[o+1]));o+=74;var T=s.slice(o,o+20),A=u.validateEthereumMsgResponse({signer:T,sig:I},r);h.data={sig:{v:A.v,r:A.r.toString("hex"),s:A.s.toString("hex")},signer:T}}return h}},{key:"_resetActiveWallets",value:function(){this.activeWallets.internal.uid=B,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=B,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null}},{key:"getActiveWallet",value:function(){return B.equals(this.activeWallets.external.uid)?B.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external}},{key:"hasActiveWallet",value:function(){return null!==this.getActiveWallet()}},{key:"pubKeyBytes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.key.getPublic().encode("hex"),r=M.from(t,"hex");if(!0===e){var n=r.slice(1,33).reverse(),i=r.slice(33,65).reverse();return M.concat([r[0],n,i])}return r}},{key:"parseAbi",value:function(e,t){switch(e){case"etherscan":return h[e](t);default:return{err:"No ".concat(e," parser available.")}}}}])&&t(n.prototype,i),c&&t(n,c),r}()},u0zn:function(e,t,r){var n=r("tjlA").Buffer,i=r("HFX+").keccak256,o=r("L21C").ETH_ABI_LATTICE_FW_TYPE_MAP;t.MAX_ABI_DEFS=2,t.buildAddAbiPayload=function(e){if(!e||!Array.isArray(e))throw new Error("Missing definitions.");if(e.length>t.MAX_ABI_DEFS)throw new Error("You may only add 2 ABI definitions per request.");var r=n.alloc(1147),i=0;return r.writeUInt8(e.length,i),i++,e.forEach(function(e){if(!e.sig||!e.name||!e.params)throw new Error("name, sig, and params must be present for every ABI definition.");var t=n.from(e.sig,"hex");if(4!==t.length)throw new Error("Function signatures must always be four bytes.");if(t.copy(r,i),i+=t.length,n.from(e.name).length>99)throw new Error("Only function names shorter than 100 characters are supported.");n.from(e.name).slice(0,100).copy(r,i),i+=100;var o=Array.isArray(e.params)?e.params.length:0;if(r.writeUInt8(o,i),i++,o>18)throw new Error("Currently only ABI defintions with <=10 parameters are supported.");o>0?(e.params.forEach(function(e){if(!e.name||!e.latticeTypeIdx||void 0===e.isArray||void 0===e.arraySz)throw new Error("name, latticeTypeIdx, isArray, and arraySz must be defined for all ABI params.");n.from(e.name).slice(0,20).copy(r,i),i+=20}),i+=20*(18-o),e.params.forEach(function(e){r.writeUInt8(e.latticeTypeIdx,i),i++,r.writeUInt8(!0===e.isArray,i),i++,r.writeUInt32LE(e.arraySz,i),i+=4}),i+=6*(18-o)):i+=468}),r},t.abiParsers={etherscan:function(e){var t=[];return e.forEach(function(e){if(e.name&&e.inputs&&"function"===e.type&&"view"!==e.stateMutability){var r=(c="".concat((u=e).name,"("),u.inputs.forEach(function(e){c+="".concat(e.type,",")}),u.inputs.length>0&&(c=c.slice(0,c.length-1)),i(c+=")").slice(0,8)),n=(s=e.inputs,a=[],s.forEach(function(e){var t=e.type,r={isArray:!1,arraySz:0,name:e.name},n=t.indexOf("["),i=t.indexOf("]");if(n>-1&&i>-1)if(n>=i);else if(n+1===i)r.isArray=!0;else{var s=parseInt(t.slice(n,i));if(isNaN(s))return r;r.isArray=!0,r.arraySz=s}var u=n>-1?t.slice(0,n):t;if(r.latticeTypeIdx=o[u],!r.latticeTypeIdx)throw new Error("Unsupported type: ".concat(t));a.push(r)}),a);t.push({name:e.name,sig:r,params:n})}var s,a,u,c}),t}}},vGFC:function(e,t,r){"use strict";(function(e){t.a=function(t,r,n){void 0===n&&(n=!1);for(var i=n?r.length:t.length,o=e.alloc(i),s=0;s<i;s++)o[s]=~(t[n?s%t.length:s]^r[s]);return o}}).call(this,r("tjlA").Buffer)},xKF7:function(e,t,r){var n=r("kB5k"),i=r("tjlA").Buffer,o=r("L21C"),s=r("HFX+").keccak256,a=r("RP9m"),u=r("IzB8");function c(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function l(e,t,r,n,o){try{var a=new Uint8Array(i.from(s(e),"hex")),c=0,l=f(t.r,32);t.r=l;var p=f(t.s,32);t.s=p;var g=new Uint8Array(i.concat([l,p])),v=u.ecdsaRecover(g,c,a,!1).slice(1);if(h(v)===r.toString("hex"))return t.v=d(c,o,n),t;if(c=1,h(v=u.ecdsaRecover(g,c,a,!1).slice(1))===r.toString("hex"))return t.v=d(c,o,n),t;throw new Error("Invalid Ethereum signature returned.")}catch(y){throw new Error(y)}}function h(e){return s(e).slice(-40)}function f(e,t){var r=i.alloc(t);return e.length<t?(e.copy(r,t-e.length),r):e.slice(-t)}function d(e,t,r){if(!1===t)return i.from(new n(e).plus(27).toString(16),"hex");var o=g(r);return y(new n(o.toString("hex"),16).times(2).plus(35).plus(e).toString(16))}t.buildEthereumMsgRequest=function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");var t,r={schema:o.signingSchema.ETH_MSG,payload:null,input:e,msg:null};if("signPersonal"===e.protocol){var n=0;r.payload=i.alloc(4*(e.signerPath.length+1)+e.ethMaxMsgSz+4),r.payload.writeUInt8(o.ethMsgProtocol.SIGN_PERSONAL,0),n+=1,r.payload.writeUInt32LE(e.signerPath.length,n),n+=4;for(var s=0;s<e.signerPath.length;s++)r.payload.writeUInt32LE(e.signerPath[s],n),n+=4;var a=e.payload,u=!1;if("string"==typeof e.payload)if("0x"===e.payload.slice(0,2))a=y(e.payload),u=!0===(t=e.payload.slice(2),/^[0-9a-fA-F]+$/.test(t));else{if(!1===function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)<32||e.charCodeAt(t)>127)return!1;return!0}(e.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");a=i.from(e.payload)}else"boolean"==typeof e.displayHex&&(u=e.displayHex);if(r.msg=a,r.payload.writeUInt8(u,n),n+=1,r.payload.writeUInt16LE(a.length,n),n+=2,a.length>e.ethMaxMsgSz)throw new Error("Your message is ".concat(a.length," bytes, but can only be a maximum of ").concat(e.ethMaxMsgSz));return a.copy(r.payload,n),r}throw new Error("Unsupported protocol")},t.validateEthereumMsgResponse=function(e,t){var r=e.signer,n=e.sig,o=t.input,s=t.msg;if("signPersonal"===o.protocol){var a=i.from("\x19Ethereum Signed Message:\n".concat(s.length.toString()),"utf-8");return l(i.concat([a,s]),n,r)}throw new Error("Unsupported protocol")},t.buildEthereumTxRequest=function(e){try{var t=e.chainId,r=void 0===t?1:t,n=e.signerPath,s=e.eip155,a=void 0===s?null:s,u=e.ethMaxDataSz;if("number"!=typeof r&&!1===v(r)&&(r=p[r]),!r)throw new Error("Unsupported chain ID or name");if(!n||5!==n.length)throw new Error("Please provider full signer path (`signerPath`)");var c=function(e){switch(e){case 3:case 4:return!1;case 1:case 42:case 5:default:return!0}}(r);null!==a&&"boolean"==typeof a&&(c=a),e.value||(e.value=0);var l=[],h=y(e.nonce),f=y(e.gasPrice),d=y(e.gasLimit),E=y(e.to),_=y(e.value),m=y(e.data);l.push(h),l.push(f),l.push(d),l.push(E),l.push(_),l.push(m),!0===c&&(l.push(y(r)),l.push(y(null)),l.push(y(null)));var w,b=i.alloc(u+122),S=0;b.writeUInt8(Number(c),S),S++;var R=0;if(!0==(1!==(T=g(r)).length||255===T.readUInt8(0))){if((R=(w=g(r)).length)>o.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");b.writeUInt8(o.HANDLE_LARGER_CHAIN_ID,S),S++}else{if(1!==(w=y(r)).length)throw new Error("Error parsing chainID");w.copy(b,S),S+=w.length}b.writeUInt32LE(n.length,S),S+=4;for(var I=0;I<n.length;I++)b.writeUInt32LE(n[I],S),S+=4;if(b.writeUInt32BE(e.nonce,S),S+=4,function(e,t,r){"number"==typeof e&&(e=e.toString(16));var n=i.alloc(8),o=e.length%2==0?e.toString(16):"0".concat(e.toString(16)),s=i.from(o,"hex");s.copy(n,n.length-s.length),n.copy(t,r)}(e.gasPrice,b,S),S+=8,b.writeUInt32BE(e.gasLimit,S),S+=4,E.copy(b,S),S+=20,_.copy(b,S+32-_.length),S+=32,m&&m.length>u)return{err:"Data field too large (must be <=".concat(u," bytes)")};if(b.writeUInt16BE(m.length,S),S+=2,m.length+R>u)throw new Error("Payload too large.");return R>0&&(b.writeUInt8(R,S),S++,w.copy(b,S),S+=R),m.copy(b,S),S+=u,{rawTx:l,payload:b,schema:o.signingSchema.ETH_TRANSFER,chainId:r,useEIP155:c,signerPath:n}}catch(A){return{err:A.message}}var T},t.buildEthRawTx=function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=l(a.encode(e.rawTx),t,r,e.chainId,n),o=e.rawTx.slice(0,6);return o.push(i.v),o.push(c(i.r)),o.push(c(i.s)),a.encode(o).toString("hex")},t.addRecoveryParam=l,t.hashTransaction=function(e){return s(i.from(e,"hex"))};var p={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function g(e){var t,r;if((t=!0===v(e)?y(e):y(new n(e).toString(16))).length>8)throw new Error("ChainID provided is too large.");return t.length<=2||4===t.length||8===t.length?t:(3===t.length?(r=i.alloc(4)).writeUInt32BE(e):t.length<=8&&(r=i.alloc(8),t.copy(r,8-t.length)),r)}function v(e){return!1===new n(e,16).isNaN()}function y(e){return null===e||0===e?i.alloc(0):(i.isBuffer(e)&&(e=e.toString("hex")),"number"==typeof e?e="".concat(e.toString(16)):"string"==typeof e&&"0x"===e.slice(0,2)&&(e=e.slice(2)),e.length%2>0&&(e="0".concat(e)),i.from(e,"hex"))}t.chainIds=p,t.ensureHexBuffer=y}}])}();