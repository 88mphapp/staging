(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"/yFf":function(t,e,n){"use strict";var r=n("oHnp");function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}t.exports=i,i.prototype.get=function(t){return this.header[t.toLowerCase()]},i.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=r.type(e);var n=r.params(e);for(var i in n)this[i]=n[i];this.links={};try{t.link&&(this.links=r.parseLinks(t.link))}catch(o){}},i.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.created=201==t,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t,this.unprocessableEntity=422==t}},"24Ii":function(t,e,n){var r;"undefined"!=typeof window?r=window:"undefined"!=typeof self?r=self:(console.warn("Using browser-only version of superagent in non-browser environment"),r=this);var i=n("cpc2"),o=n("kMlx"),s=n("8zgK"),a=n("/yFf"),c=n("nZbv");function u(){}var l=e=t.exports=function(t,n){return"function"==typeof n?new e.Request("GET",t).end(n):1==arguments.length?new e.Request("GET",t):new e.Request(t,n)};e.Request=E,l.getXHR=function(){if(!(!r.XMLHttpRequest||r.location&&"file:"==r.location.protocol&&r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only version of superagent could not find XHR")};var h="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function f(t){if(!s(t))return t;var e=[];for(var n in t)d(e,n,t[n]);return e.join("&")}function d(t,e,n){if(null!=n)if(Array.isArray(n))n.forEach((function(n){d(t,e,n)}));else if(s(n))for(var r in n)d(t,e+"["+r+"]",n[r]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));else null===n&&t.push(encodeURIComponent(e))}function p(t){for(var e,n,r={},i=t.split("&"),o=0,s=i.length;o<s;++o)-1==(n=(e=i[o]).indexOf("="))?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function g(t){return/[\/+]json($|[^-\w])/.test(t)}function y(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=function(t){for(var e,n,r,i,o=t.split(/\r?\n/),s={},a=0,c=o.length;a<c;++a)-1!==(e=(n=o[a]).indexOf(":"))&&(r=n.slice(0,e).toLowerCase(),i=h(n.slice(e+1)),s[r]=i);return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body=null===this.text&&t._responseType?this.xhr.response:"HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function E(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",(function(){var t,e=null,r=null;try{r=new y(n)}catch(i){return(e=new Error("Parser is unable to parse the response")).parse=!0,e.original=i,n.xhr?(e.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",r);try{n._isResponseOK(r)||(t=new Error(r.statusText||"Unsuccessful HTTP response"))}catch(o){t=o}t?(t.original=e,t.response=r,t.status=r.status,n.callback(t,r)):n.callback(null,r)}))}function _(t,e,n){var r=l("DELETE",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}l.serializeObject=f,l.parseString=p,l.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},l.serialize={"application/x-www-form-urlencoded":f,"application/json":JSON.stringify},l.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse},a(y.prototype),y.prototype._parseBody=function(t){var e=l.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&g(this.type)&&(e=l.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},y.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r=new Error("cannot "+e+" "+n+" ("+this.status+")");return r.status=this.status,r.method=e,r.url=n,r},l.Response=y,i(E.prototype),o(E.prototype),E.prototype.type=function(t){return this.set("Content-Type",l.types[t]||t),this},E.prototype.accept=function(t){return this.set("Accept",l.types[t]||t),this},E.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"==typeof e&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});var r=function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(t,e,n,r)},E.prototype.query=function(t){return"string"!=typeof t&&(t=f(t)),t&&this._query.push(t),this},E.prototype.attach=function(t,e,n){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,n||e.name)}return this},E.prototype._getFormData=function(){return this._formData||(this._formData=new r.FormData),this._formData},E.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var n=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),n(t,e)},E.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},E.prototype.buffer=E.prototype.ca=E.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},E.prototype.pipe=E.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},E.prototype._isHost=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},E.prototype.end=function(t){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||u,this._finalizeQueryString(),this._end()},E.prototype._end=function(){var t=this,e=this.xhr=l.getXHR(),n=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var n=e.readyState;if(n>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4==n){var r;try{r=e.status}catch(i){r=0}if(!r){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var r=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{e.onprogress=r.bind(null,"download"),e.upload&&(e.upload.onprogress=r.bind(null,"upload"))}catch(a){}try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(c){return this.callback(c)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var i=this._header["content-type"],o=this._serializer||l.serialize[i?i.split(";")[0]:""];!o&&g(i)&&(o=l.serialize["application/json"]),o&&(n=o(n))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&e.setRequestHeader(s,this.header[s]);return this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0!==n?n:null),this},l.agent=function(){return new c},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(t){c.prototype[t.toLowerCase()]=function(e,n){var r=new l.Request(t,e);return this._setDefaults(r),n&&r.end(n),r}})),c.prototype.del=c.prototype.delete,l.get=function(t,e,n){var r=l("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},l.head=function(t,e,n){var r=l("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},l.options=function(t,e,n){var r=l("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.del=_,l.delete=_,l.patch=function(t,e,n){var r=l("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.post=function(t,e,n){var r=l("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},l.put=function(t,e,n){var r=l("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},"2k3W":function(t,e,n){"use strict";n.r(e),n.d(e,"bits",(function(){return i})),n.d(e,"buffer",(function(){return _})),n.d(e,"byte",(function(){return v})),n.d(e,"integer",(function(){return m})),n.d(e,"nibble",(function(){return w})),n.d(e,"string",(function(){return b}));for(var r=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=1^t[n];return e},i={and:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r]&e[r];return n},nand:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r]&e[r]^1;return n},nor:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=1^(t[r]|e[r]);return n},not:r,or:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r]|e[r];return n},reduceAnd:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e&=t[n];return e},reduceNand:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e=e&t[n]^1;return e},reduceNor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e=1^(e|t[n]);return e},reduceOr:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e|=t[n];return e},reduceXnor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e^=1^t[n];return e},reduceXor:function(t){if(t.length<2)throw new RangeError("Not enough bits.");for(var e=t[0],n=1;n<t.length;n++)e^=t[n];return e},toBoolean:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=1===t[n];return e},toString:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=" "),!e)return t.join("");for(var r="",i=0;i<t.length;i++)r+=""+t[i],i%e==e-1&&i!==t.length-1&&(r+=n);return r},xnor:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r]^e[r]^1;return n},xor:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}},o=n("XUzR"),s=n("GCxg"),a=n("G1u+"),c=function(t){if(t>255||t<0||~~t!==t)throw new RangeError("invalid byte");for(var e=[0,0,0,0,0,0,0,0],n=0;n<8;n++)e[7-n]=t>>n&1;return e},u=function(t,e,n){void 0===e&&(e=0),n||(n=8*t.length-e);var r=Math.floor(e/8),i=Math.floor(n/8)+2,o=[];o.length=8*i;for(var s=0;s<i;s++)if(void 0!==t[r+s]){var a=c(t[r+s]);o[8*s]=a[0],o[8*s+1]=a[1],o[8*s+2]=a[2],o[8*s+3]=a[3],o[8*s+4]=a[4],o[8*s+5]=a[5],o[8*s+6]=a[6],o[8*s+7]=a[7]}var u=e%8;return o.slice(u,u+n)},l=n("nMdu"),h=n("ILq/"),f=n("f7RY"),d=n("YnKP"),p=[],g=0;g<32;g++)p[g]=Math.pow(2,g);var y=n("vGFC"),E=n("5tNv"),_={and:o.a,create:s.a,modify:function(t,e,n){void 0===n&&(n=0);for(var r=Math.floor(n/8),i=Math.ceil((n+e.length)/8),o=t.slice(r,i),s=u(o),c=n%8,l=0;l<e.length;l++)s[c++]=e[l];for(var h=i-r,f=0;f<h;f++)o[f]=Object(a.a)(s.slice(8*f,8*(f+1)))},nand:l.a,nor:h.a,not:f.a,or:d.a,read:u,readInt:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=8);var i=u(t,e,n);if(0===i[0]){for(var o=0,s=0;s<n;s++)i[s]&&(o+=p[n-s-1]);return o}o=-1;var a=r(i);for(s=0;s<n;s++)a[s]&&(o-=p[n-s-1]);return o},readUInt:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=8);for(var r=u(t,e,n),i=0,o=0;o<n;o++)i+=r[o]*p[n-o-1];return i},xnor:y.a,xor:E.a},v={read:c,write:a.a},m={getBit:function(t,e){return t>>e&1},setBit:function(t,e,n){return 1===n?t|1<<e:t&~(1<<e)},toggleBit:function(t,e){return t^1<<e}},w={read:function(t){if(t<16&&t>=0&&Math.floor(t)===t){for(var e=[0,0,0,0],n=0;n<4;n++)e[3-n]=t>>n&1;return e}throw new RangeError("invalid array length")},write:function(t){if(!Array.isArray(t)||4!==t.length)throw new RangeError("invalid array length");for(var e=0,n=0;n<4;n++)t[3-n]&&(e|=1<<n);return e}},b={toBits:function(t){for(var e=[],n=0;n<t.length;n++)"1"===t[n]?e.push(1):"0"===t[n]&&e.push(0);return e}};e.default={bits:i,buffer:_,byte:v,integer:m,nibble:w,string:b}},"4Mn8":function(t,e,n){const r=n("pzNo");t.exports={Client:r}},"5tNv":function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=e[r?s%e.length:s]^n[s];return o}}).call(this,n("tjlA").Buffer)},"6WMX":function(t,e,n){const r=n("B3Rj"),i=n("b3gk"),o=n("tjlA").Buffer,s=n("L21C"),a=o.from("01","hex"),{HARDENED_OFFSET:c}=n("L21C"),u=[44+c,c,c,1,0],l={LEGACY:0,SEGWIT:5,TESTNET:111,SEGWIT_TESTNET:196};e.addressVersion=l;const h={P2PKH:1,P2SH:2,P2SH_P2WPKH:3};function f(t,e){return o.concat([t,e])}function d(t){const e=o.alloc(4);return e.writeUInt32LE(t),e}function p(t){let e;return t<253?(e=o.alloc(1),e.writeUInt8(t)):t<=65535?(e=o.alloc(3),e.writeUInt8(253,0),e.writeUInt16LE(t,1)):t<4294967295?(e=o.alloc(5),e.writeUInt8(254,0),e.writeUInt32LE(t,1)):(e=o.alloc(9),e.writeUInt8(255,0),e.writeUInt32LE(t>>>0,1),e.writeUInt32LE(t/4294967296|0,5)),e}function g(t,e,n){"number"==typeof t&&(t=t.toString(16));const r=o.alloc(8),i=t.length%2==0?t.toString(16):"0"+t.toString(16);return o.from(i,"hex").reverse().copy(r,0),r.copy(e,n),r}e.scriptTypes=h,e.buildBitcoinTxRequest=function(t){try{const{prevOuts:e,recipient:n,value:a,changePath:c=u,fee:f,isSegwit:d,changeVersion:p="SEGWIT"}=t;if(5!==c.length)throw new Error("Please provide a full change path.");const y=o.alloc(59+69*e.length);let E=0;if(void 0===l[p])throw new Error("Invalid change version specified.");y.writeUInt8(l[p]),E++,y.writeUInt32LE(c.length,E),E+=4;for(let t=0;t<c.length;t++)y.writeUInt32LE(c[t],E),E+=4;y.writeUInt32LE(f,E),E+=4;const _=r.decode(n)[0],v=i.decode(n).slice(1);y.writeUInt8(_,E),E++,v.copy(y,E),E+=v.length,g(a,y,E),E+=8,y.writeUInt8(e.length,E),E++;let m=0;const w=!0===d?h.P2SH_P2WPKH:h.P2PKH;return e.forEach(t=>{if(!t.signerPath||5!==t.signerPath.length)throw new Error("Full recipient path not specified ");y.writeUInt32LE(t.signerPath.length,E),E+=4;for(let e=0;e<t.signerPath.length;e++)y.writeUInt32LE(t.signerPath[e],E),E+=4;y.writeUInt32LE(t.index,E),E+=4,g(t.value,y,E),E+=8,m+=t.value,y.writeUInt8(w,E),E++,o.isBuffer(t.txHash)||(t.txHash=o.from(t.txHash,"hex")),t.txHash.copy(y,E),E+=t.txHash.length}),{payload:y,schema:s.signingSchema.BTC_TRANSFER,origData:t,changeData:{changeVersion:p,value:m-(a+f)}}}catch(e){return{err:e}}},e.serializeTx=function(t){const{inputs:e,outputs:n,isSegwitSpend:s,lockTime:c=0,crypto:u}=t;let h=o.alloc(4),y=0;h.writeUInt32LE(2,y),y+=4,!0===s&&(h=f(h,o.from("00","hex")),h=f(h,o.from("01","hex")));const E=p(e.length);h=f(h,E),y+=E.length,e.forEach(t=>{h=f(h,t.hash.reverse()),y+=t.hash.length;const e=d(t.index);if(h=f(h,e),y+=e.length,!0===s){const e=function(t,e){const n=o.alloc(22),r=e.createHash("sha256").update(t).digest(),i=e.createHash("rmd160").update(r).digest();return n.writeUInt8(0),n.writeUInt8(i.length,1),i.copy(n,2),n}(t.pubkey,u),n=p(e.length),r=o.concat([n,e]),i=p(r.length);h=f(h,i),y+=i.length,h=f(h,r),y+=r.length}else{const e=function(t,e){const n=p((t=o.concat([t,a])).length),r=p(e.length),i=o.concat([n,t,r,e]),s=p(i.length);return o.concat([s,i])}(t.sig,t.pubkey);h=f(h,e),y+=e.length}const n=d(4294967295);h=f(h,n),y+=n.length});const _=p(n.length);if(h=f(h,_),y+=_.length,n.forEach(t=>{const e=function(t){const e=o.alloc(8);return g(t,e,0),e}(t.value);h=f(h,e),y+=e.length;const n=function(t){const e=r.decode(t)[0],n=i.decode(t).slice(1);return e===l.SEGWIT||e===l.SEGWIT_TESTNET?function(t){const e=o.alloc(3+t.length);let n=0;return e.writeUInt8(169,n),n++,e.writeUInt8(t.length,n),n++,t.copy(e,n),n+=t.length,e.writeUInt8(135,n),n++,e}(n):function(t){const e=o.alloc(5+t.length);let n=0;return e.writeUInt8(118,n),n++,e.writeUInt8(169,n),n++,e.writeUInt8(t.length,n),n++,t.copy(e,n),n+=t.length,e.writeUInt8(136,n),n++,e.writeUInt8(172,n),n++,e}(n)}(t.recipient),s=p(n.length);h=f(h,s),y+=s.length,h=f(h,n),y+=n.length}),!0===s){const t=[],n=[];for(let i=0;i<e.length;i++)t.push(e[i].sig),n.push(e[i].pubkey);const r=function(t,e){let n=o.alloc(0);const r=o.alloc(1);r.writeUInt8(2);for(let i=0;i<t.length;i++){const s=o.concat([t[i],a]),c=p(s.length),u=e[i],l=p(u.length);n=o.concat([n,r,c,s,l,u])}return n}(t,n);h=f(h,r),y+=r.length}return o.concat([h,d(c)]).toString("hex")},e.getBitcoinAddress=function(t,e){return i.encode(o.concat([o.from([e]),t]))}},"8zgK":function(t,e,n){"use strict";t.exports=function(t){return null!==t&&"object"==typeof t}},"G1u+":function(t,e,n){"use strict";e.a=function(t){if(!Array.isArray(t)||8!==t.length)throw new RangeError("invalid array length");for(var e=0,n=0;n<8;n++)t[7-n]&&(e|=1<<n);return e}},GCxg:function(t,e,n){"use strict";(function(t){var r=n("G1u+");e.a=function(e){for(var n=[0,0,0,0,0,0,0,0],i=t.alloc(Math.ceil(e.length/8)),o=0;o<i.length;o++){for(var s=0;s<8;s++)n[s]=e[8*o+s]?e[8*o+s]:0;i[o]=Object(r.a)(n)}return i}}).call(this,n("tjlA").Buffer)},"ILq/":function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=~(e[r?s%e.length:s]|n[s]);return o}}).call(this,n("tjlA").Buffer)},L21C:function(t,e){const n={finalizePair:0,getAddresses:1290,sign:1090,getWallets:142,addAbiDefs:8,test:1646};let r=0;Object.keys(n).forEach(t=>{n[t]+82>r&&(r=n[t]+82)});const i={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WALLET_NOT_PRESENT:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141};t.exports={getFwVersionConst:function(t){const e={reqMaxDataSz:1152};return 0===t.length||t[1]<10&&0===t[2]?(e.ethMaxDataSz=e.reqMaxDataSz-128,e.ethMaxMsgSz=e.ethMaxDataSz,e.ethMaxGasPrice=5e11,e.addrFlagsAllowed=!1):t[1]>=10&&t[2]>=0&&(e.reqMaxDataSz=1678,e.ethMaxDataSz=e.reqMaxDataSz-128,e.ethMaxMsgSz=e.ethMaxDataSz,e.ethMaxGasPrice=2e13,e.addrFlagsAllowed=!0),e},ADDR_STR_LEN:129,AES_IV:[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100],BASE_URL:"https://signing.gridpl.us",ENC_MSG_LEN:r,addressSizes:{BTC:20,ETH:20},decResLengths:n,deviceCodes:{CONNECT:1,ENCRYPTED_REQUEST:2},encReqCodes:{FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_ABI_DEFS:6,TEST:7},ethMsgProtocol:{SIGN_PERSONAL:0},messageConstants:{NOT_PAIRED:0,PAIRED:1},responseCodes:i,responseMsgs:{[i.RESP_SUCCESS]:0,[i.RESP_ERR_INVALID_MSG]:"Invalid Request",[i.RESP_ERR_UNSUPPORTED_VER]:"Unsupported Version",[i.RESP_ERR_DEV_BUSY]:"Device Busy",[i.RESP_ERR_USER_TIMEOUT]:"Timeout Waiting for User",[i.RESP_ERR_USER_DECLINED]:"Request Declined by User",[i.RESP_ERR_PAIR_FAIL]:"Pairing Failed",[i.RESP_ERR_PAIR_DISABLED]:"Pairing is Currently Disabled",[i.RESP_ERR_PERMISSION_DISABLED]:"Automated Signing is Currently Disabled",[i.RESP_ERR_INTERNAL]:"Device Error",[i.RESP_ERR_GCE_TIMEOUT]:"Timeout",[i.RESP_ERR_WALLET_NOT_PRESENT]:"Incorrect Wallet UID Provided",[i.RESP_ERR_DEV_LOCKED]:"Device Locked",[i.RESP_ERR_DISABLED]:"Disabled",[i.RESP_ERR_ALREADY]:"Record already exists. You must first remove it on your device."},signingSchema:{BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3},REQUEST_TYPE_BYTE:2,VERSION_BYTE:1,HARDENED_OFFSET:2147483648,HANDLE_LARGER_CHAIN_ID:255,MAX_CHAIN_ID_BYTES:8,ETH_ABI_LATTICE_FW_TYPE_MAP:{address:1,bool:2,uint8:3,uint16:4,uint32:5,uint64:6,uint128:7,uint256:8,uint:15,bytes1:17,bytes2:18,bytes3:19,bytes4:20,bytes5:21,bytes6:22,bytes7:23,bytes8:24,bytes9:25,bytes10:26,bytes11:27,bytes12:28,bytes13:29,bytes14:30,bytes15:31,bytes16:32,bytes17:33,bytes18:34,bytes19:35,bytes20:36,bytes21:37,bytes22:38,bytes23:39,bytes24:40,bytes25:41,bytes26:42,bytes27:43,bytes28:44,bytes29:45,bytes30:46,bytes31:47,bytes32:48,bytes:49,string:50}}},PLHu:function(t,e,n){const{buildBitcoinTxRequest:r}=n("6WMX"),{buildEthereumTxRequest:i,buildEthereumMsgRequest:o,ensureHexBuffer:s}=n("xKF7"),a=n("tjlA").Buffer,c=n("cke4"),u=n("cC09"),l=n("MzeL"),{AES_IV:h,responseCodes:f,responseMsgs:d,VERSION_BYTE:p}=n("L21C"),g=new(0,l.ec)("p256");function y(t){return u.buf(t)>>>0}t.exports={isValidAssetPath:function(t){const e=2147483648,n=[e,2147483649,2147483708],r=[e];return[2147483697,2147483692].indexOf(t[0])>=0&&n.indexOf(t[1])>=0&&r.indexOf(t[2])>=0&&[0,1].indexOf(t[3])>=0},ensureHexBuffer:s,signReqResolver:{BTC:r,ETH:i,ETH_MSG:o},aes256_decrypt:function(t,e){const n=a.from(h),r=new c.ModeOfOperation.cbc(e,n);return a.from(r.decrypt(t))},aes256_encrypt:function(t,e){const n=a.from(h),r=new c.ModeOfOperation.cbc(e,n),i=t.length%16==0?t:c.padding.pkcs7.pad(t);return a.from(r.encrypt(i))},parseDER:function(t){if(48!==t[0]||2!==t[2])return null;let e=3;const n={r:null,s:null},r=t[e];if(e++,n.r=t.slice(e,e+r),e+=r,2!==t[e])return null;e++;const i=t[e];return e++,n.s=t.slice(e,e+i),n},checksum:y,parseLattice1Response:function(t){const e={err:null,data:null},n=a.from(t,"hex");let r=0;const i=n.readUInt8(r);if(r++,i!==p)return e.err="Incorrect protocol version. Please update your SDK",e;const o=n.readUInt8(r);if(r++,0!==o)return e.err="Incorrect response from Lattice1",e;n.readUInt32BE(r),r+=4;const s=n.readUInt16BE(r);r+=2;const c=n.slice(r,r+s);r+=s;const u=c.readUInt8(0);return u!==f.RESP_SUCCESS?(e.err="Error from device: "+(d[u]?d[u]:"Unknown Error"),e.responseCode=u,e):(e.data=c.slice(1,c.length),n.readUInt32BE(r)!==y(n.slice(0,n.length-4))?(e.err="Invalid checksum from device response",e.data=null,e):e)},getP256KeyPair:function(t){return g.keyFromPrivate(t,"hex")},getP256KeyPairFromPub:function(t){return g.keyFromPublic(t,"hex")},toPaddedDER:function(t){const e=a.alloc(74);return a.from(t.toDER()).copy(e),e}}},RP9m:function(t,e,n){const r=n("9lTW"),i=n("tjlA").Buffer;function o(t,e){if("00"===t.slice(0,2))throw new Error("invalid RLP: extra zeros");return parseInt(t,e)}function s(t,e){if(t<56)return new i([t+e]);var n=c(t),r=c(e+55+n.length/2);return new i(r+n,"hex")}function a(t){return"0x"===t.slice(0,2)}function c(t){var e=t.toString(16);return e.length%2&&(e="0"+e),e}function u(t){if(!i.isBuffer(t))if("string"==typeof t)t=a(t)?new i(((n="string"!=typeof(r=t)?r:a(r)?r.slice(2):r).length%2&&(n="0"+n),n),"hex"):new i(t);else if("number"==typeof t)t?(e=c(t),t=new i(e,"hex")):t=new i([]);else if(null==t)t=new i([]);else{if(!t.toArray)throw new Error("invalid type");t=new i(t.toArray())}var e,n,r;return t}e.encode=function(t){if(t instanceof Array){for(var n=[],r=0;r<t.length;r++)n.push(e.encode(t[r]));var o=i.concat(n);return i.concat([s(o.length,192),o])}return 1===(t=u(t)).length&&t[0]<128?t:i.concat([s(t.length,128),t])},e.decode=function(t,e){if(!t||0===t.length)return new i([]);var n=function t(e){var n,r,s,a,c,u=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(n=l-127,s=128===l?new i([]):e.slice(1,n),2===n&&s[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:s,remainder:e.slice(n)}}if(l<=191){if(n=o(e.slice(1,r=l-182).toString("hex"),16),(s=e.slice(r,n+r)).length<n)throw new Error("invalid RLP");return{data:s,remainder:e.slice(n+r)}}if(l<=247){for(a=e.slice(1,n=l-191);a.length;)c=t(a),u.push(c.data),a=c.remainder;return{data:u,remainder:e.slice(n)}}var h=(r=l-246)+(n=o(e.slice(1,r).toString("hex"),16));if(h>e.length)throw new Error("invalid rlp: total length is larger than the data");if(0===(a=e.slice(r,h)).length)throw new Error("invalid rlp, List has a invalid length");for(;a.length;)c=t(a),u.push(c.data),a=c.remainder;return{data:u,remainder:e.slice(h)}}(t=u(t));return e?n:(r.equal(n.remainder.length,0,"invalid remainder"),n.data)},e.getLength=function(t){if(!t||0===t.length)return new i([]);var e=(t=u(t))[0];if(e<=127)return t.length;if(e<=183)return e-127;if(e<=191)return e-182;if(e<=247)return e-191;var n=e-246;return n+o(t.slice(1,n).toString("hex"),16)}},T8MV:function(t,e,n){(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n("HEbw"),h=n("+qE3").EventEmitter,f=n("4Mn8"),d="Lattice Hardware",p=2147483648,g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(g,t);var n,r,o,h=(r=g,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(r);if(o){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)});function g(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,g),(t=h.call(this)).type=d,t._resetDefaults(),t.deserialize(e),t}return(n=[{key:"deserialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.creds&&(this.creds=t.creds),t.accounts&&(this.accounts=t.accounts),t.walletUID&&(this.walletUID=t.walletUID),t.name&&(this.name=t.name),t.network&&(this.network=t.network),Promise.resolve()}},{key:"serialize",value:function(){return Promise.resolve({creds:this.creds,accounts:this.accounts,walletUID:this.walletUID,name:this.name,network:this.network})}},{key:"isUnlocked",value:function(){return this._hasCreds()&&this._hasSession()}},{key:"setHdPath",value:function(){console.warn("setHdPath not implemented.")}},{key:"unlock",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n,r){t._getCreds().then((function(e){return e&&(t.creds.deviceID=e.deviceID,t.creds.password=e.password),t._initSession()})).then((function(){return t._connect(e)})).then((function(){return n("Unlocked")})).catch((function(t){return r(Error(t))}))}))}},{key:"addAccounts",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(n,r){return-1e3===e?(t.forgetDevice(),n([])):e<=0?r("Number of accounts to add must be a positive number."):void t.unlock().then((function(){return t._fetchAddresses(e,t.unlockedAccount)})).then((function(r){var o;return t.accounts.splice(t.unlockedAccount,e),(o=t.accounts).splice.apply(o,[t.unlockedAccount,0].concat(i(r))),n(t.accounts)})).catch((function(t){return r(t)}))}))}},{key:"getAccounts",value:function(){return Promise.resolve(this.accounts?this.accounts.slice():[].slice())}},{key:"signTransaction",value:function(t,n){var r=this;return new Promise((function(i,o){r._unlockAndFindAccount(t).then((function(t){var e={chainId:n.getChainId(),nonce:Number("0x".concat(n.nonce.toString("hex")))||0,gasPrice:Number("0x".concat(n.gasPrice.toString("hex"))),gasLimit:Number("0x".concat(n.gasLimit.toString("hex"))),to:"0x".concat(n.to.toString("hex")),value:Number("0x".concat(n.value.toString("hex"))),data:0===n.data.length?null:"0x".concat(n.data.toString("hex")),signerPath:[2147483692,2147483708,p,0,t]};return r._signTxData(e)})).then((function(t){return t.sig&&t.sig.v&&t.sig.r&&t.sig.s?(n.v=t.sig.v,n.r=e.from(t.sig.r,"hex"),n.s=e.from(t.sig.s,"hex"),i(n)):o(Error("No signature returned"))})).catch((function(t){return o(Error(t))}))}))}},{key:"signPersonalMessage",value:function(t,e){return this.signMessage(t,{payload:e,protocol:"signPersonal"})}},{key:"signMessage",value:function(t,e){var n=this;return new Promise((function(r,i){n._unlockAndFindAccount(t).then((function(t){var o=e.payload,s=e.protocol;if(!o||!s)return i("`payload` and `protocol` fields must be included in the request");var a={currency:"ETH_MSG",data:{protocol:s,payload:o,signerPath:[2147483692,2147483708,p,0,t]}};if(!n._hasSession())return i("No SDK session started. Cannot sign transaction.");n.sdkSession.sign(a,(function(t,e){if(t)return i(t);if(!e.sig)return i("No signature returned");var n=(e.sig.v-27).toString(16);return n.length<2&&(n="0".concat(n)),r("0x".concat(e.sig.r).concat(e.sig.s).concat(n))}))}))}))}},{key:"exportAccount",value:function(t){return Promise.reject(Error("exportAccount not supported by this device"))}},{key:"removeAccount",value:function(t){this.forgetDevice()}},{key:"getFirstPage",value:function(){return this.page=0,this._getPage(1)}},{key:"getNextPage",value:function(){return this.getFirstPage()}},{key:"getPreviousPage",value:function(){return this.getFirstPage()}},{key:"setAccountToUnlock",value:function(t){this.unlockedAccount=parseInt(t,10)}},{key:"forgetDevice",value:function(){this._resetDefaults()}},{key:"_unlockAndFindAccount",value:function(t){var e=this;return new Promise((function(n,r){e.unlock(!1).then((function(){return e.getAccounts()})).then((function(e){var i=null;return e.forEach((function(e,n){t.toLowerCase()===e.toLowerCase()&&(i=n)})),null===i?r("Signer not present"):n(i)})).catch((function(t){return r(t)}))}))}},{key:"_resetDefaults",value:function(){this.accounts=[],this.isLocked=!0,this.creds={deviceID:null,password:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null}},{key:"_getCreds",value:function(){var t=this;return new Promise((function(e,n){if(t._hasCreds())return e();var r=t.name?t.name:"Unknown",i="https://wallet.gridplus.io";t.network&&"mainnet"!==t.network&&(i="https://gridplus-web-wallet-dev.herokuapp.com");var o="".concat(i,"?keyring=").concat(r);t.network&&(o+="&network=".concat(t.network)),window.open(o).postMessage("GET_LATTICE_CREDS",i),window.addEventListener("message",(function(t){if(t.origin===i)try{var r=JSON.parse(t.data);return r.deviceID&&r.password?e(r):n(Error("Invalid credentials returned from Lattice."))}catch(o){return n(o)}}),!1)}))}},{key:"_connect",value:function(t){var e=this;return new Promise((function(n,r){e.sdkSession.connect(e.creds.deviceID,(function(i){if(i)return r(i);var o=e.sdkSession.getActiveWallet();if(!o||!o.uid)return r("No active wallet");var s=o.uid.toString("hex");if(s!=e.walletUID){if(!1===t)return r("Wallet has changed! Please reconnect.");e.accounts=[],e.walletUID=s}return n()}))}))}},{key:"_initSession",value:function(){var t=this;return new Promise((function(e,n){if(t._hasSession())return e();try{var r="https://signing.gridpl.us";t.network&&"mainnet"!==t.network&&(r="https://signing.staging-gridpl.us");var i={name:t.name,baseUrl:r,crypto:l,timeout:12e4,privKey:t._genSessionKey(),network:t.network};return t.sdkSession=new f.Client(i),e()}catch(o){return n(o)}}))}},{key:"_fetchAddresses",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r,i){return t._hasSession()?n>t.accounts.length?i("Requested address is out of bounds. You may only request index <".concat(t.accounts.length)):t.accounts.length>n?r(t.accounts.slice(n,e)):void t.sdkSession.getAddresses({currency:"ETH",startPath:[2147483692,2147483708,p,0,n],n:e},(function(t,e){return t?i(Error("Error getting addresses: ".concat(t))):e.length<1?i("No addresses returned"):r(e)})):i("No SDK session started. Cannot fetch addresses.")}))}},{key:"_signTxData",value:function(t){var e=this;return new Promise((function(n,r){if(!e._hasSession())return r("No SDK session started. Cannot sign transaction.");e.sdkSession.sign({currency:"ETH",data:t},(function(t,e){return t?r(t):e.tx?n(e):r("No transaction payload returned.")}))}))}},{key:"_getPage",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(n,r){t.page+=e,t.page<=0&&(t.page=1);var i=5*(t.page-1);t.unlock().then((function(){return t._fetchAddresses(1,0)})).then((function(t){var e=[];return t.forEach((function(t,n){e.push({address:t,balance:null,index:i+n})})),n(e)})).catch((function(t){return r(t)}))}))}},{key:"_hasCreds",value:function(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.name}},{key:"_hasSession",value:function(){return this.sdkSession&&this.walletUID}},{key:"_genSessionKey",value:function(){if(!this._hasCreds())throw new Error("No credentials -- cannot create session key!");var t=e.concat([e.from(this.creds.password),e.from(this.creds.deviceID),e.from(this.name)]);return l.createHash("sha256").update(t).digest()}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(g.prototype,n),g}(h);g.type=d,t.exports=g}).call(this,n("tjlA").Buffer)},XUzR:function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=e[r?s%e.length:s]&n[s];return o}}).call(this,n("tjlA").Buffer)},YnKP:function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=e[r?s%e.length:s]|n[s];return o}}).call(this,n("tjlA").Buffer)},cC09:function(t,e,n){var r;r=function(t){t.version="1.2.0";var e=function(){for(var t=0,e=new Array(256),n=0;256!=n;++n)e[n]=t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=1&(t=n)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1)?-306674912^t>>>1:t>>>1;return"undefined"!=typeof Int32Array?new Int32Array(e):e}();t.table=e,t.bstr=function(t,n){for(var r=-1^n,i=t.length-1,o=0;o<i;)r=(r=r>>>8^e[255&(r^t.charCodeAt(o++))])>>>8^e[255&(r^t.charCodeAt(o++))];return o===i&&(r=r>>>8^e[255&(r^t.charCodeAt(o))]),-1^r},t.buf=function(t,n){if(t.length>1e4)return function(t,n){for(var r=-1^n,i=t.length-7,o=0;o<i;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])];for(;o<i+7;)r=r>>>8^e[255&(r^t[o++])];return-1^r}(t,n);for(var r=-1^n,i=t.length-3,o=0;o<i;)r=(r=(r=(r=r>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])])>>>8^e[255&(r^t[o++])];for(;o<i+3;)r=r>>>8^e[255&(r^t[o++])];return-1^r},t.str=function(t,n){for(var r,i,o=-1^n,s=0,a=t.length;s<a;)(r=t.charCodeAt(s++))<128?o=o>>>8^e[255&(o^r)]:r<2048?o=(o=o>>>8^e[255&(o^(192|r>>6&31))])>>>8^e[255&(o^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),i=1023&t.charCodeAt(s++),o=(o=(o=(o=o>>>8^e[255&(o^(240|r>>8&7))])>>>8^e[255&(o^(128|r>>2&63))])>>>8^e[255&(o^(128|i>>6&15|(3&r)<<4))])>>>8^e[255&(o^(128|63&i))]):o=(o=(o=o>>>8^e[255&(o^(224|r>>12&15))])>>>8^e[255&(o^(128|r>>6&63))])>>>8^e[255&(o^(128|63&r))];return-1^o}},"undefined"==typeof DO_NOT_EXPORT_CRC?r(e):r({})},cpc2:function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},f7RY:function(t,e,n){"use strict";(function(t){e.a=function(e){for(var n=t.alloc(e.length),r=0;r<e.length;r++)n[r]=~e[r];return n}}).call(this,n("tjlA").Buffer)},kMlx:function(t,e,n){"use strict";var r=n("8zgK");function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}t.exports=i,i.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},i.prototype.parse=function(t){return this._parser=t,this},i.prototype.responseType=function(t){return this._responseType=t,this},i.prototype.serialize=function(t){return this._serializer=t,this},i.prototype.timeout=function(t){if(!t||"object"!=typeof t)return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},i.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];i.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(t,e);if(!0===n)return!0;if(!1===n)return!1}catch(r){console.error(r)}if(e&&e.status&&e.status>=500&&501!=e.status)return!0;if(t){if(t.code&&~o.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"==t.code)return!0;if(t.crossDomain)return!0}return!1},i.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},i.prototype.then=function(t,e){if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((function(t,e){n.end((function(n,r){n?e(n):t(r)}))}))}return this._fullfilledPromise.then(t,e)},i.prototype.catch=function(t){return this.then(void 0,t)},i.prototype.use=function(t){return t(this),this},i.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},i.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},i.prototype.getHeader=i.prototype.get=function(t){return this._header[t.toLowerCase()]},i.prototype.set=function(t,e){if(r(t)){for(var n in t)this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},i.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},i.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),r(t)){for(var n in t)this.field(n,t[n]);return this}if(Array.isArray(e)){for(var i in e)this.field(t,e[i]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},i.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},i.prototype._auth=function(t,e,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},i.prototype.withCredentials=function(t){return null==t&&(t=!0),this._withCredentials=t,this},i.prototype.redirects=function(t){return this._maxRedirects=t,this},i.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw TypeError("Invalid argument");return this._maxResponseSize=t,this},i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},i.prototype.send=function(t){var e=r(t),n=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&r(this._data))for(var i in t)this._data[i]=t[i];else"string"==typeof t?(n||this.type("form"),this._data="application/x-www-form-urlencoded"==(n=this._header["content-type"])?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)||n||this.type("json"),this},i.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},i.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var n=this.url.substring(e+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,e)+"?"+n.join("&")}}},i.prototype._appendQueryString=function(){console.trace("Unsupported")},i.prototype._timeoutError=function(t,e,n){if(!this._aborted){var r=new Error(t+e+"ms exceeded");r.timeout=e,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},i.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout((function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")}),this._responseTimeout))}},nMdu:function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=~(e[r?s%e.length:s]&n[s]);return o}}).call(this,n("tjlA").Buffer)},nZbv:function(t,e){function n(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach((function(t){n.prototype[t]=function(){return this._defaults.push({fn:t,arguments:arguments}),this}})),n.prototype._setDefaults=function(t){this._defaults.forEach((function(e){t[e.fn].apply(t,e.arguments)}))},t.exports=n},oHnp:function(t,e,n){"use strict";e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce((function(t,e){var n=e.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(t[r]=i),t}),{})},e.parseLinks=function(t){return t.split(/ *, */).reduce((function(t,e){var n=e.split(/ *; */),r=n[0].slice(1,-1);return t[n[1].split(/ *= */)[1].slice(1,-1)]=r,t}),{})},e.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t}},pzNo:function(t,e,n){const r=n("2k3W"),i=n("24Ii"),o=n("6WMX"),s=n("xKF7"),{buildAddAbiPayload:a,abiParsers:c,MAX_ABI_DEFS:u}=n("u0zn"),{isValidAssetPath:l,signReqResolver:h,aes256_decrypt:f,aes256_encrypt:d,parseDER:p,checksum:g,ensureHexBuffer:y,getP256KeyPair:E,getP256KeyPairFromPub:_,parseLattice1Response:v,toPaddedDER:m}=n("PLHu"),{getFwVersionConst:w,ADDR_STR_LEN:b,ENC_MSG_LEN:S,decResLengths:R,deviceCodes:I,encReqCodes:A,responseCodes:T,REQUEST_TYPE_BYTE:P,VERSION_BYTE:x,messageConstants:D,BASE_URL:k}=n("L21C"),U=n("tjlA").Buffer,C=U.alloc(32);t.exports=class{constructor({baseUrl:t,crypto:e,name:n,privKey:r,timeout:i,retryCount:o}={}){if(n&&n.length>24)throw new Error("name must be less than 24 characters");if(!e)throw new Error("crypto provider is required");this.baseUrl=t||k,this.crypto=e,this.name=n||"Unknown",this.privKey=r||this.crypto.randomBytes(32),this.key=E(this.privKey),this.ephemeralPub=null,this.sharedSecret=null,this.timeout=i||6e4,this.deviceId=null,this.isPaired=!1,this.retryCount=o||3,this.activeWallets={internal:{uid:C,name:null,capabilities:null,external:!1},external:{uid:C,name:null,capabilities:null,external:!0}}}connect(t,e){if("function"==typeof t){if(!this.deviceId)return e("No device ID has been stored. Please connect with your device ID first.");e=t}else this.deviceId=t;const n=this._buildRequest(I.CONNECT,this.pubKeyBytes());this._request(n,(t,n)=>t?e(t):(this.isPaired=this._handleConnect(n),this.isPaired?void this._getActiveWallet(t=>e(t,this.isPaired),!0):e(null)))}pair(t,e){const n=this.pubKeyBytes(),r=U.alloc(25);if(this.name.length>24)return e("Name is too many characters. Please change it to <25 characters.");r.write(this.name);const i=U.concat([n,r,U.from(t)]),o=this.crypto.createHash("sha256").update(i).digest(),s=this.key.sign(o),a=m(s),c=U.concat([r,a]),u=this._buildEncRequest(A.FINALIZE_PAIRING,c);this._request(u,(t,n)=>{if(t)return e(t);const r=this._handlePair(n);if(r)return e(r);this._getActiveWallet(t=>t?e(t):e(null,this.hasActiveWallet()),!0)})}test(t,e){if(!t.payload)return e("First argument must contain `testID` and `payload` fields.");const n=U.alloc(506);n.writeUInt32BE(t.testID,0),n.writeUInt16BE(t.payload.length,4),t.payload.copy(n,6);const r=this._buildEncRequest(A.TEST,n);this._request(r,(t,n)=>{if(t)return e(t);const r=this._handleEncResponse(n,R.test);return null!==r.err?e(r.err):e(null,r.data.slice(65))})}getAddresses(t,e){const{startPath:n,n:i,skipCache:o=!0}=t;if(void 0===n||void 0===i||5!==n.length)return e("Please provide `startPath` and `n` options");if(i>10)return e("You may only request 10 addresses at once.");if(!0===o&&!1===l(n))return e("Parent path is not supported");const s=U.alloc(33+4*n.length);let a=0;const c=this.getActiveWallet();if(null===c)return e("No active wallet.");c.uid.copy(s,a),a+=32;for(let r=0;r<n.length;r++)s.writeUInt32BE(n[r],a),a+=4;let u;if(!0===w(this.fwVersion).addrFlagsAllowed){const t=r.nibble.read(!0===o?1:0),e=r.nibble.read(i);u=r.byte.write(t.concat(e))}else u=i;s.writeUInt8(u,a),a++;const h=this._buildEncRequest(A.GET_ADDRESSES,s);return this._request(h,(t,n)=>{if(t)return e(t);const r=this._handleGetAddresses(n);return r.err?e(r.err):e(null,r.data)})}sign(t,e){const{currency:n,data:r}=t;if(void 0===n||void 0===r)return e("Please provide `currency` and `data` options");if(void 0===h[n])return e("Unsupported currency");const i=w(this.fwVersion);r.ethMaxDataSz=i.ethMaxDataSz,r.ethMaxMsgSz=i.ethMaxMsgSz;const o=h[n](r);if(void 0!==o.err)return e({err:o.err});if(o.payload.length>i.reqMaxDataSz)return e("Transaction is too large");const s=U.alloc(2+i.reqMaxDataSz);let a=0;s.writeUInt16BE(o.schema,a),a+=2;const c=this.getActiveWallet();if(null===c)return e("No active wallet.");c.uid.copy(s,a),a+=c.uid.length,o.payload.copy(s,a);const u=this._buildEncRequest(A.SIGN_TRANSACTION,s);return this._request(u,(r,i,s)=>{if(s===T.RESP_ERR_WALLET_NOT_PRESENT)this._getActiveWallet(n=>n?e(n):this.sign(t,e));else{if(!r){const t=this._handleSign(i,n,o);return e(t.err,t.data)}if(r)return e(r)}})}addAbiDefs(t,e,n=null){const r=t.slice(0,u);let i;t=t.slice(u);try{i=a(r)}catch(c){return e(c)}const o=U.alloc(i.length+10);o.writeUInt16LE(t.length),null!==n&&n.copy(o,2),i.copy(o,10);const s=this._buildEncRequest(A.ADD_ABI_DEFS,o);return this._request(s,(r,i,o)=>{if(o&&o!==T.RESP_SUCCESS)return e("Error making request.");if(r)return e(r);const s=this._handleEncResponse(i,R.addAbiDefs);if(n=s.data.slice(65,73),0===t.length)return e(null);this.addAbiDefs(t,e,n,t)})}addPermissionV0(t,e){const{currency:n,timeWindow:r,limit:i,decimals:o,asset:s}=t;if(!n||void 0===r||void 0===i||void 0===o||null===r||null===i||null===o)return e("currency, timeWindow, decimals, and limit are all required options.");if(0===r||0===i)return e("Time window and spending limit must be positive.");let a=n;s&&(a+="_"+s);const c=U.alloc(293);if(U.from(a).length>255)return e("Asset name too long.");U.from(a).copy(c,0);const u=y(i);if(u.length>32)return e("Limit too large.");u.copy(c,32-u.length+256),c.writeUInt32BE(r,288),c.writeUInt8(o,292);const l=this._buildEncRequest(A.ADD_PERMISSION_V0,c);return this._request(l,(n,r,i)=>{if(i===T.RESP_ERR_WALLET_NOT_PRESENT)this._getActiveWallet(n=>n?e(n):this.addPermissionV0(t,e));else{if(!n){const t=this._handleEncResponse(r,R.finalizePair);return e(t.err?t.err:null)}if(n)return e(n)}})}_getActiveWallet(t,e=!1){if(!0===e||!0!==this.hasActiveWallet()&&!0===this.isPaired){const e=U.alloc(0),n=this._buildEncRequest(A.GET_WALLETS,e);return this._request(n,(e,n)=>e?(this._resetActiveWallets(),t(e)):t(this._handleGetWallets(n)))}return t(null)}_getSharedSecret(){return U.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))}_getEphemId(){if(null===this.ephemeralPub)return null;const t=this._getSharedSecret();return this.crypto.createHash("sha256").update(t).digest().slice(0,4)}_buildEncRequest(t,e){const n=parseInt(this._getEphemId().toString("hex"),16),r=U.concat([U.from([t]),e]),i=g(r),o=U.alloc(r.length+4);r.copy(o,0),o.writeUInt32LE(i,r.length);const s=this._getSharedSecret(),a=d(o,s),c=U.alloc(S+4);return c.writeUInt32LE(n,0),a.copy(c,4),this._buildRequest(I.ENCRYPTED_REQUEST,c)}_buildRequest(t,e){let n=e&&U.isBuffer(e)?e.length+1:1;t===I.ENCRYPTED_REQUEST&&(n=1+e.length);let r=0;const i=U.alloc(n+8);r=i.writeUInt8(x,r),r=i.writeUInt8(P,r);const o=this.crypto.randomBytes(4);r=i.writeUInt32BE(parseInt("0x"+o.toString("hex")),r),r=i.writeUInt16BE(n,r),r=i.writeUInt8(t,r),n>1&&(r=e.copy(i,r));const s=g(i),a=U.alloc(i.length+4);return r=i.copy(a),a.writeUInt32BE(s,r),a}_request(t,e,n=this.retryCount){if(!this.deviceId)return e("Serial is not set. Please set it and try again.");i.post(`${this.baseUrl}/${this.deviceId}`).timeout(this.timeout).send({data:t}).then(r=>{if(!r||!r.body)return e("Invalid response: "+r);if(200!==r.body.status)return e(`Error code ${r.body.status}: ${r.body.message}`);const i=v(r.body.message);return(i.responseCode===T.RESP_ERR_DEV_BUSY||i.responseCode===T.RESP_ERR_GCE_TIMEOUT)&&n>0?setTimeout(()=>{this._request(t,e,n-1)},3e3):(i.responseCode===T.RESP_ERR_WALLET_NOT_PRESENT&&this._resetActiveWallets(),i.err?e(i.err):e(null,i.data,i.responseCode))}).catch(t=>e("ECONNABORTED"===t.code&&"ETIME"===t.errno?"Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.":"Failed to make request to device."))}_handleConnect(t){let e=0;const n=t.readUInt8(e);e++;const r=t.slice(e,e+65).toString("hex");return e+=65,this.fwVersion=t.slice(e,e+4),this.ephemeralPub=_(r),n===D.PAIRED}_handleEncResponse(t,e){const n=this._getSharedSecret(),r=t.slice(0,S),i=f(r,n),o=i.slice(0,e+=65),s=parseInt("0x"+i.slice(e,e+4).toString("hex")),a=g(o);if(s!==a)return{err:`Checksum mismatch in response from Lattice (calculated ${a}, wanted ${s})`};const c=i.slice(0,65).toString("hex");try{return this.ephemeralPub=_(c),{err:null,data:i}}catch(u){return{err:"Error handling getAddresses response: "+u.toString()}}}_handlePair(t){const e=this._handleEncResponse(t,R.finalizePair);return e.err?e.err:(this.pairingSalt=null,this.isPaired=!0,null)}_handleGetAddresses(t){const e=this._handleEncResponse(t,R.getAddresses);if(null!==e.err)return e;const n=e.data;let r=65;const i=[];for(;r+4<R.getAddresses;){const t=n.slice(r,r+b);r+=b;const e=t.indexOf(0);e>0&&i.push(t.slice(0,e).toString())}return{data:i,err:null}}_handleGetWallets(t){const e=this._handleEncResponse(t,R.getWallets);if(null!==e.err)return e;const n=e.data;let r,i=65,o=!1;return r=n.slice(i,i+32),this.activeWallets.internal.uid=r,this.activeWallets.internal.capabilities=n.readUInt32BE(i+32),this.activeWallets.internal.name=n.slice(i+36,i+71),r.equals(C)||(o=!0),i+=71,r=n.slice(i,i+32),this.activeWallets.external.uid=r,this.activeWallets.external.capabilities=n.readUInt32BE(i+32),this.activeWallets.external.name=n.slice(i+36,i+71),r.equals(C)||(o=!0),!0===o?null:"No active wallet."}_handleSign(t,e,n=null){const r=this._handleEncResponse(t,R.sign);if(null!==r.err)return{err:r.err};let i=65;const a=r.data;let c;if("BTC"===e){const t=o.addressVersion[n.changeData.changeVersion],e=a.slice(i,i+20);i+=20,c=o.getBitcoinAddress(e,t)}const u={err:null,data:null};if("BTC"===e){const t=33,e=[],r=[];let s=0;for(;i<a.length&&48===a[i];)r.push(a.slice(i,i+2+a[i+1])),e.push(a.slice(s*t+825,(s+1)*t+825)),i+=74,s+=1;const l={inputs:[],outputs:[],isSegwitSpend:n.origData.isSegwit,network:n.origData.network,crypto:this.crypto};l.outputs.push({value:n.origData.value,recipient:n.origData.recipient}),n.changeData.value>0&&l.outputs.push({value:n.changeData.value,recipient:c});for(let i=0;i<r.length;i++)l.inputs.push({hash:n.origData.prevOuts[i].txHash,index:n.origData.prevOuts[i].index,sig:r[i],pubkey:e[i]});const h=o.serializeTx(l);let f=h;!0===l.isSegwitSpend&&(l.isSegwitSpend=!1,f=o.serializeTx(l));let d=this.crypto.createHash("sha256").update(U.from(f,"hex")).digest();d=this.crypto.createHash("sha256").update(d).digest().reverse().toString("hex"),u.data={tx:h,txHash:d,changeRecipient:c,sigs:r}}else if("ETH"===e){const t=p(a.slice(i,i+2+a[i+1]));i+=74;const e=a.slice(i,i+20),r=s.buildEthRawTx(n,t,e,n.useEIP155);u.data={tx:"0x"+r,txHash:"0x"+s.hashTransaction(r),sig:{v:t.v,r:t.r.toString("hex"),s:t.s.toString("hex")},signer:e}}else if("ETH_MSG"===e){const t=p(a.slice(i,i+2+a[i+1]));i+=74;const e=a.slice(i,i+20),r=s.validateEthereumMsgResponse({signer:e,sig:t},n);u.data={sig:{v:r.v,r:r.r.toString("hex"),s:r.s.toString("hex")},signer:e}}return u}_resetActiveWallets(){this.activeWallets.internal.uid=C,this.activeWallets.internal.name=null,this.activeWallets.internal.capabilities=null,this.activeWallets.external.uid=C,this.activeWallets.external.name=null,this.activeWallets.external.capabilities=null}getActiveWallet(){return C.equals(this.activeWallets.external.uid)?C.equals(this.activeWallets.internal.uid)?null:this.activeWallets.internal:this.activeWallets.external}hasActiveWallet(){return null!==this.getActiveWallet()}pubKeyBytes(t=!1){const e=this.key.getPublic().encode("hex"),n=U.from(e,"hex");if(!0===t){const t=n.slice(1,33).reverse(),e=n.slice(33,65).reverse();return U.concat([n[0],t,e])}return n}parseAbi(t,e){switch(t){case"etherscan":return c[t](e);default:return{err:`No ${t} parser available.`}}}}},u0zn:function(t,e,n){const r=n("tjlA").Buffer,i=n("HFX+").keccak256,{ETH_ABI_LATTICE_FW_TYPE_MAP:o}=n("L21C");e.MAX_ABI_DEFS=2,e.buildAddAbiPayload=function(t){if(!t||!Array.isArray(t))throw new Error("Missing definitions.");if(t.length>e.MAX_ABI_DEFS)throw new Error("You may only add 2 ABI definitions per request.");const n=r.alloc(1147);let i=0;return n.writeUInt8(t.length,i),i++,t.forEach(t=>{if(!t.sig||!t.name||!t.params)throw new Error("name, sig, and params must be present for every ABI definition.");const e=r.from(t.sig,"hex");if(4!==e.length)throw new Error("Function signatures must always be four bytes.");if(e.copy(n,i),i+=e.length,r.from(t.name).length>99)throw new Error("Only function names shorter than 100 characters are supported.");r.from(t.name).slice(0,100).copy(n,i),i+=100;const o=Array.isArray(t.params)?t.params.length:0;if(n.writeUInt8(o,i),i++,o>18)throw new Error("Currently only ABI defintions with <=10 parameters are supported.");o>0?(t.params.forEach(t=>{if(!t.name||!t.latticeTypeIdx||void 0===t.isArray||void 0===t.arraySz)throw new Error("name, latticeTypeIdx, isArray, and arraySz must be defined for all ABI params.");r.from(t.name).slice(0,20).copy(n,i),i+=20}),i+=20*(18-o),t.params.forEach(t=>{n.writeUInt8(t.latticeTypeIdx,i),i++,n.writeUInt8(!0===t.isArray,i),i++,n.writeUInt32LE(t.arraySz,i),i+=4}),i+=6*(18-o)):i+=468}),n},e.abiParsers={etherscan:function(t){const e=[];return t.forEach(t=>{if(t.name&&t.inputs&&"function"===t.type&&"view"!==t.stateMutability){const n=function(t){let e=t.name+"(";return t.inputs.forEach(t=>{e+=t.type+","}),t.inputs.length>0&&(e=e.slice(0,e.length-1)),e+=")",i(e).slice(0,8)}(t),r=function(t){const e=[];return t.forEach(t=>{const n=t.type,r={isArray:!1,arraySz:0,name:t.name},i=n.indexOf("["),s=n.indexOf("]");if(i>-1&&s>-1)if(i>=s);else if(i+1===s)r.isArray=!0;else{const t=parseInt(n.slice(i,s));if(isNaN(t))return r;r.isArray=!0,r.arraySz=t}const a=i>-1?n.slice(0,i):n;if(r.latticeTypeIdx=o[a],!r.latticeTypeIdx)throw new Error("Unsupported type: "+n);e.push(r)}),e}(t.inputs);e.push({name:t.name,sig:n,params:r})}}),e}}},vGFC:function(t,e,n){"use strict";(function(t){e.a=function(e,n,r){void 0===r&&(r=!1);for(var i=r?n.length:e.length,o=t.alloc(i),s=0;s<i;s++)o[s]=~(e[r?s%e.length:s]^n[s]);return o}}).call(this,n("tjlA").Buffer)},xKF7:function(t,e,n){const r=n("kB5k"),i=n("tjlA").Buffer,o=n("L21C"),s=n("HFX+").keccak256,a=n("RP9m"),c=n("IzB8");function u(t){let e=t[0];for(;t.length>0&&"0"===e.toString();)e=(t=t.slice(1))[0];return t}function l(t,e,n,r,o){try{const a=new Uint8Array(i.from(s(t),"hex"));let u=0;const l=f(e.r,32);e.r=l;const p=f(e.s,32);e.s=p;const g=new Uint8Array(i.concat([l,p]));let y=c.ecdsaRecover(g,u,a,!1).slice(1);if(h(y)===n.toString("hex"))return e.v=d(u,o,r),e;if(u=1,y=c.ecdsaRecover(g,u,a,!1).slice(1),h(y)===n.toString("hex"))return e.v=d(u,o,r),e;throw new Error("Invalid Ethereum signature returned.")}catch(a){throw new Error(a)}}function h(t){return s(t).slice(-40)}function f(t,e){const n=i.alloc(e);return t.length<e?(t.copy(n,e-t.length),n):t.slice(-e)}function d(t,e,n){if(!1===e)return i.from(new r(t).plus(27).toString(16),"hex");const o=g(n);return E(new r(o.toString("hex"),16).times(2).plus(35).plus(t).toString(16))}e.buildEthereumMsgRequest=function(t){if(!t.payload||!t.protocol||!t.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");const e={schema:o.signingSchema.ETH_MSG,payload:null,input:t,msg:null};if("signPersonal"===t.protocol){let r=0;e.payload=i.alloc(4*(t.signerPath.length+1)+t.ethMaxMsgSz+4),e.payload.writeUInt8(o.ethMsgProtocol.SIGN_PERSONAL,0),r+=1,e.payload.writeUInt32LE(t.signerPath.length,r),r+=4;for(let n=0;n<t.signerPath.length;n++)e.payload.writeUInt32LE(t.signerPath[n],r),r+=4;let s=t.payload,a=!1;if("string"==typeof t.payload)if("0x"===t.payload.slice(0,2))s=E(t.payload),a=!0===(n=t.payload.slice(2),/^[0-9a-fA-F]+$/.test(n));else{if(!1===function(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)<32||t.charCodeAt(e)>127)return!1;return!0}(t.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");s=i.from(t.payload)}else"boolean"==typeof t.displayHex&&(a=t.displayHex);if(e.msg=s,e.payload.writeUInt8(a,r),r+=1,e.payload.writeUInt16LE(s.length,r),r+=2,s.length>t.ethMaxMsgSz)throw new Error(`Your message is ${s.length} bytes, but can only be a maximum of ${t.ethMaxMsgSz}`);return s.copy(e.payload,r),e}throw new Error("Unsupported protocol");var n},e.validateEthereumMsgResponse=function(t,e){const{signer:n,sig:r}=t,{input:o,msg:s}=e;if("signPersonal"===o.protocol){const t=i.from("\x19Ethereum Signed Message:\n"+s.length.toString(),"utf-8");return l(i.concat([t,s]),r,n)}throw new Error("Unsupported protocol")},e.buildEthereumTxRequest=function(t){try{let{chainId:e=1}=t;const{signerPath:n,eip155:r=null,ethMaxDataSz:s}=t;if("number"!=typeof e&&!1===y(e)&&(e=p[e]),!e)throw new Error("Unsupported chain ID or name");if(!n||5!==n.length)throw new Error("Please provider full signer path (`signerPath`)");let a=function(t){switch(t){case 3:case 4:return!1;case 1:case 42:case 5:default:return!0}}(e);null!==r&&"boolean"==typeof r&&(a=r),t.value||(t.value=0);const c=[],u=E(t.nonce),l=E(t.gasPrice),h=E(t.gasLimit),f=E(t.to),d=E(t.value),_=E(t.data);c.push(u),c.push(l),c.push(h),c.push(f),c.push(d),c.push(_),!0===a&&(c.push(E(e)),c.push(E(null)),c.push(E(null)));const v=i.alloc(s+122);let m,w=0;v.writeUInt8(Number(a),w),w++;let b=0;if(!0===function(t){const e=g(t);return 1!==e.length||255===e.readUInt8(0)}(e)){if(m=g(e),b=m.length,b>o.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");v.writeUInt8(o.HANDLE_LARGER_CHAIN_ID,w),w++}else{if(m=E(e),1!==m.length)throw new Error("Error parsing chainID");m.copy(v,w),w+=m.length}v.writeUInt32LE(n.length,w),w+=4;for(let t=0;t<n.length;t++)v.writeUInt32LE(n[t],w),w+=4;if(v.writeUInt32BE(t.nonce,w),w+=4,function(t,e,n){"number"==typeof t&&(t=t.toString(16));const r=i.alloc(8),o=t.length%2==0?t.toString(16):"0"+t.toString(16),s=i.from(o,"hex");s.copy(r,r.length-s.length),r.copy(e,n)}(t.gasPrice,v,w),w+=8,v.writeUInt32BE(t.gasLimit,w),w+=4,f.copy(v,w),w+=20,d.copy(v,w+32-d.length),w+=32,_&&_.length>s)return{err:`Data field too large (must be <=${s} bytes)`};if(v.writeUInt16BE(_.length,w),w+=2,_.length+b>s)throw new Error("Payload too large.");return b>0&&(v.writeUInt8(b,w),w++,m.copy(v,w),w+=b),_.copy(v,w),w+=s,{rawTx:c,payload:v,schema:o.signingSchema.ETH_TRANSFER,chainId:e,useEIP155:a,signerPath:n}}catch(e){return{err:e.message}}},e.buildEthRawTx=function(t,e,n,r=!0){const i=l(a.encode(t.rawTx),e,n,t.chainId,r),o=t.rawTx.slice(0,6);return o.push(i.v),o.push(u(i.r)),o.push(u(i.s)),a.encode(o).toString("hex")},e.addRecoveryParam=l,e.hashTransaction=function(t){return s(i.from(t,"hex"))};const p={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function g(t){let e,n;if(e=!0===y(t)?E(t):E(new r(t).toString(16)),e.length>8)throw new Error("ChainID provided is too large.");return e.length<=2||4===e.length||8===e.length?e:(3===e.length?(n=i.alloc(4),n.writeUInt32BE(t)):e.length<=8&&(n=i.alloc(8),e.copy(n,8-e.length)),n)}function y(t){return!1===new r(t,16).isNaN()}function E(t){return null===t||0===t?i.alloc(0):(i.isBuffer(t)&&(t=t.toString("hex")),"number"==typeof t?t=""+t.toString(16):"string"==typeof t&&"0x"===t.slice(0,2)&&(t=t.slice(2)),t.length%2>0&&(t="0"+t),i.from(t,"hex"))}e.chainIds=p,e.ensureHexBuffer=E}}]);